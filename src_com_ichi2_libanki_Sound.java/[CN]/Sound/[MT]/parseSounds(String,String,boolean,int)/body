{
  boolean soundAvailable=false;
  StringBuilder stringBuilder=new StringBuilder();
  String contentLeft=content;
  Log.i(AnkiDroidApp.TAG,"parseSounds");
  Matcher matcher=sSoundPattern.matcher(content);
  while (matcher.find()) {
    soundAvailable=true;
    String sound=matcher.group(1);
    String soundPath=soundDir + Uri.encode(sound);
    if (!sSoundPaths.containsKey(qa)) {
      sSoundPaths.put(qa,new ArrayList<String>());
    }
    sSoundPaths.get(qa).add(soundPath);
    String soundMarker=matcher.group();
    int markerStart=contentLeft.indexOf(soundMarker);
    stringBuilder.append(contentLeft.substring(0,markerStart));
    stringBuilder.append("<a onclick=\"window.ankidroid.playSound(this.title);\" title=\"" + soundPath + "\"><span style=\"padding:5px;display:inline-block;vertical-align:middle\"><img src=\"file:///android_asset/media_playback_start2.png\" /></span></a>");
    contentLeft=contentLeft.substring(markerStart + soundMarker.length());
    Log.i(AnkiDroidApp.TAG,"Content left = " + contentLeft);
  }
  if (!soundAvailable && ttsEnabled && !ReadText.getLanguage(qa).equals(ReadText.NO_TTS)) {
    stringBuilder.append(content.substring(0,content.length() - 9));
    stringBuilder.append("<a onclick=\"window.ankidroid.playSound(this.title);\" title=\"tts" + Integer.toString(qa) + Utils.stripHTML(content)+ "\"><span style=\"padding:5px;display:inline-block;vertical-align:middle\"><img src=\"file:///android_asset/media_playback_start2.png\" /></span></a>");
    contentLeft="</p>";
  }
  stringBuilder.append(contentLeft);
  return stringBuilder.toString();
}
