{
  Log.d(AnkiDroidApp.TAG,"BroadcastMessage.DownloadBroadcastMessage.onPostExecute()");
  if (!mShowDialog) {
    return;
  }
  StyledDialog.Builder builder=new StyledDialog.Builder(context);
  if (mText != null && mText.length() > 0) {
    WebView view=new WebView(context);
    view.setBackgroundColor(context.getResources().getColor(Themes.getDialogBackgroundColor()));
    view.loadDataWithBaseURL("","<html><body text=\"#FFFFFF\">" + mText + "</body></html>","text/html","UTF-8","");
    builder.setView(view);
    builder.setCancelable(true);
    builder.setNegativeButton(context.getResources().getString(R.string.close),new DialogInterface.OnClickListener(){
      @Override public void onClick(      DialogInterface dialog,      int which){
        setMessageRead(mContext,mNum,mIsLastMessage);
      }
    }
);
  }
 else {
    return;
  }
  if (mTitle != null && mTitle.length() > 0) {
    builder.setTitle(mTitle);
  }
  if (mUrl != null && mUrl.length() > 0) {
    builder.setPositiveButton(context.getResources().getString(R.string.visit),new DialogInterface.OnClickListener(){
      @Override public void onClick(      DialogInterface dialog,      int which){
        setMessageRead(mContext,mNum,mIsLastMessage);
        String action="android.intent.action.VIEW";
        if (Utils.isIntentAvailable(mContext,action)) {
          Intent i=new Intent(action,Uri.parse(mUrl));
          mContext.startActivity(i);
        }
      }
    }
);
    builder.setNeutralButton(context.getResources().getString(R.string.later),null);
  }
  try {
    mDialog=builder.create();
    mDialog.show();
  }
 catch (  BadTokenException e) {
    Log.e(AnkiDroidApp.TAG,"BroadcastMessage - BadTokenException on showing dialog: " + e);
  }
}
