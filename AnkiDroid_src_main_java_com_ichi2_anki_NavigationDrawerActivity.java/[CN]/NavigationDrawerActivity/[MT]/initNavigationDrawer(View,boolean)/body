{
  Toolbar toolbar=(Toolbar)mainView.findViewById(R.id.toolbar);
  if (toolbar != null) {
    try {
      setSupportActionBar(toolbar);
    }
 catch (    RuntimeException e) {
      Timber.e("Error setting toolbar as support actionbar");
      AnkiDroidApp.sendExceptionReport(e,"Samsung device error using Toolbar");
    }
  }
  PrimaryDrawerItem deckListItem=new PrimaryDrawerItem().withName(R.string.decks).withIcon(R.drawable.ic_list_black_24dp).withIdentifier(DRAWER_DECK_PICKER).withIconTintingEnabled(true);
  PrimaryDrawerItem browserItem=new PrimaryDrawerItem().withName(R.string.card_browser).withIcon(R.drawable.ic_search_black_24dp).withIdentifier(DRAWER_BROWSER).withIconTintingEnabled(true);
  PrimaryDrawerItem statsItem=new PrimaryDrawerItem().withName(R.string.statistics).withIcon(R.drawable.ic_equalizer_black_24dp).withIdentifier(DRAWER_STATISTICS).withIconTintingEnabled(true);
  SecondarySwitchDrawerItem nightModeItem=new SecondarySwitchDrawerItem().withName(R.string.night_mode).withChecked(AnkiDroidApp.getSharedPrefs(this).getBoolean("invertedColors",false)).withOnCheckedChangeListener(this).withSelectable(false).withIcon(R.drawable.ic_brightness_3_black_24dp).withIdentifier(DRAWER_NIGHT_MODE).withIconTintingEnabled(true);
  SecondaryDrawerItem settingsItem=new SecondaryDrawerItem().withName(R.string.settings).withIcon(R.drawable.ic_settings_black_24dp).withIdentifier(DRAWER_SETTINGS).withIconTintingEnabled(true);
  SecondaryDrawerItem helpItem=new SecondaryDrawerItem().withName(R.string.help).withIcon(R.drawable.ic_help_black_24dp).withIdentifier(DRAWER_HELP).withIconTintingEnabled(true);
  SecondaryDrawerItem feedbackItem=new SecondaryDrawerItem().withName(R.string.send_feedback).withIcon(R.drawable.ic_feedback_black_24dp).withIdentifier(DRAWER_FEEDBACK).withIconTintingEnabled(true);
  DisplayMetrics displayMetrics=getResources().getDisplayMetrics();
  float dpHeight=displayMetrics.heightPixels / displayMetrics.density;
  float dpWidth=displayMetrics.widthPixels / displayMetrics.density;
  if (dpHeight > 320 && dpWidth > 320) {
    mHeader=new AccountHeaderBuilder().withActivity(this).withHeaderBackground(Themes.getResFromAttr(this,R.attr.navDrawerImage)).withDividerBelowHeader(false).build();
  }
  DrawerBuilder builder=new DrawerBuilder().withActivity(this).withToolbar(toolbar).withAccountHeader(mHeader).withTranslucentStatusBar(true).withFullscreen(fullScreen).addDrawerItems(deckListItem,browserItem,statsItem,new DividerDrawerItem(),nightModeItem,settingsItem,helpItem,feedbackItem).withOnDrawerNavigationListener(this).withOnDrawerItemClickListener(this);
  mDrawer=builder.build();
}
