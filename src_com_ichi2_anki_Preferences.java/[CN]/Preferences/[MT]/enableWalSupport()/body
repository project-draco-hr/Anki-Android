{
  Cursor cursor=null;
  String sqliteVersion="";
  SQLiteDatabase database=null;
  try {
    database=SQLiteDatabase.openOrCreateDatabase(":memory:",null);
    cursor=database.rawQuery("select sqlite_version() AS sqlite_version",null);
    while (cursor.moveToNext()) {
      sqliteVersion=cursor.getString(0);
    }
  }
  finally {
    database.close();
    if (cursor != null) {
      cursor.close();
    }
  }
  if (sqliteVersion.length() >= 3 && Double.parseDouble(sqliteVersion.subSequence(0,3).toString()) >= 3.8) {
    walModePreference.setEnabled(true);
  }
 else {
    Log.e(AnkiDroidApp.TAG,"WAL mode not available due to a SQLite version lower than 3.7.0");
    walModePreference.setChecked(false);
  }
}
