{
  TreeMap<String,String> items=new TreeMap<String,String>();
  for (  String localeCode : mAppLanguages) {
    Locale loc;
    if (localeCode.length() > 2) {
      loc=new Locale(localeCode.substring(0,2),localeCode.substring(3,5));
    }
 else {
      loc=new Locale(localeCode);
    }
    items.put(loc.getDisplayName(),loc.toString());
  }
  mLanguageDialogLabels=new CharSequence[items.size() + 1];
  mLanguageDialogValues=new CharSequence[items.size() + 1];
  mLanguageDialogLabels[0]=getResources().getString(R.string.language_system);
  mLanguageDialogValues[0]="";
  int i=1;
  for (  Map.Entry<String,String> e : items.entrySet()) {
    mLanguageDialogLabels[i]=e.getKey();
    mLanguageDialogValues[i]=e.getValue();
    i++;
  }
  mLanguageSelection=(ListPreference)getPreferenceScreen().findPreference("language");
  mLanguageSelection.setEntries(mLanguageDialogLabels);
  mLanguageSelection.setEntryValues(mLanguageDialogValues);
}
