{
  super.onActivityResult(requestCode,resultCode,intent);
  mDontSaveOnStop=false;
  if (resultCode == RESULT_MEDIA_EJECTED) {
    showDialog(DIALOG_SD_CARD_NOT_MOUNTED);
    return;
  }
 else   if (resultCode == RESULT_DB_ERROR) {
    handleDbError();
    return;
  }
  if (requestCode == SHOW_STUDYOPTIONS && resultCode == RESULT_OK) {
    loadCounts();
  }
 else   if (requestCode == ADD_NOTE && resultCode != RESULT_CANCELED) {
    loadCounts();
  }
 else   if (requestCode == BROWSE_CARDS && (resultCode == Activity.RESULT_OK || resultCode == Activity.RESULT_CANCELED)) {
    loadCounts();
  }
 else   if (requestCode == ADD_CRAM_DECK) {
    loadCounts();
  }
 else   if (requestCode == REPORT_ERROR) {
    showStartupScreensAndDialogs(AnkiDroidApp.getSharedPrefs(getBaseContext()),4);
  }
 else   if (requestCode == SHOW_INFO_UPGRADE_DECKS) {
    if (intent != null && intent.hasExtra(Info.TYPE_UPGRADE_STAGE)) {
      int type=intent.getIntExtra(Info.TYPE_UPGRADE_STAGE,Info.UPGRADE_SCREEN_BASIC1);
      if (type == Info.UPGRADE_CONTINUE) {
        showStartupScreensAndDialogs(AnkiDroidApp.getSharedPrefs(getBaseContext()),3);
      }
 else {
        showUpgradeScreen(true,type,!intent.hasExtra(Info.TYPE_ANIMATION_RIGHT));
      }
    }
 else {
      if (resultCode == RESULT_OK) {
        if (mOpenCollectionDialog != null && mOpenCollectionDialog.isShowing()) {
          mOpenCollectionDialog.dismiss();
        }
        if (AnkiDroidApp.colIsOpen()) {
          AnkiDroidApp.closeCollection(true);
        }
        AnkiDroidApp.openCollection(AnkiDroidApp.getCollectionPath());
        loadCounts();
      }
 else {
        finishWithAnimation();
      }
    }
  }
 else   if (requestCode == SHOW_INFO_WELCOME || requestCode == SHOW_INFO_NEW_VERSION) {
    if (resultCode == RESULT_OK) {
      showStartupScreensAndDialogs(AnkiDroidApp.getSharedPrefs(getBaseContext()),requestCode == SHOW_INFO_WELCOME ? 1 : 2);
    }
 else {
      finishWithAnimation();
    }
  }
 else   if (requestCode == PREFERENCES_UPDATE) {
    String oldPath=mPrefDeckPath;
    SharedPreferences pref=restorePreferences();
    String newLanguage=pref.getString("language","");
    if (!AnkiDroidApp.getLanguage().equals(newLanguage)) {
      AnkiDroidApp.setLanguage(newLanguage);
      mInvalidateMenu=true;
    }
    if (mNotMountedDialog != null && mNotMountedDialog.isShowing() && pref.getBoolean("internalMemory",false)) {
      showStartupScreensAndDialogs(pref,0);
    }
 else     if (!mPrefDeckPath.equals(oldPath)) {
      loadCollection();
    }
  }
 else   if (requestCode == REPORT_FEEDBACK && resultCode == RESULT_OK) {
  }
 else   if (requestCode == LOG_IN_FOR_SYNC && resultCode == RESULT_OK) {
    sync();
  }
 else   if (requestCode == LOG_IN_FOR_SHARED_DECK && resultCode == RESULT_OK) {
    addSharedDeck();
  }
 else   if (requestCode == ADD_SHARED_DECKS) {
    if (intent != null) {
      mImportPath=intent.getStringExtra("importPath");
    }
    if (AnkiDroidApp.colIsOpen() && mImportPath != null) {
      DeckTask.launchDeckTask(DeckTask.TASK_TYPE_IMPORT,mImportAddListener,new TaskData(AnkiDroidApp.getCol(),mImportPath,true));
      mImportPath=null;
    }
  }
 else   if (requestCode == REQUEST_REVIEW) {
    Log.i(AnkiDroidApp.TAG,"Result code = " + resultCode);
switch (resultCode) {
default :
      loadCounts();
    break;
case Reviewer.RESULT_NO_MORE_CARDS:
  mDontSaveOnStop=true;
Intent i=new Intent();
i.setClass(this,StudyOptionsActivity.class);
i.putExtra("onlyFnsMsg",true);
startActivityForResult(i,SHOW_STUDYOPTIONS);
if (AnkiDroidApp.SDK_VERSION > 4) {
ActivityTransitionAnimation.slide(this,ActivityTransitionAnimation.RIGHT);
}
break;
}
}
BroadcastMessages.showDialog();
}
