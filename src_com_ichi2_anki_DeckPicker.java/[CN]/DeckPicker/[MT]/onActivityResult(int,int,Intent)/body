{
  super.onActivityResult(requestCode,resultCode,intent);
  mDontSaveOnStop=false;
  if (resultCode == RESULT_MEDIA_EJECTED) {
    showDialog(DIALOG_SD_CARD_NOT_MOUNTED);
    return;
  }
 else   if (resultCode == RESULT_DB_ERROR) {
    handleDbError();
    return;
  }
  if (requestCode == SHOW_STUDYOPTIONS && resultCode == RESULT_OK) {
    loadCounts();
  }
 else   if (requestCode == ADD_NOTE && resultCode != RESULT_CANCELED) {
    loadCounts();
  }
 else   if (requestCode == ADD_CRAM_DECK) {
    loadCounts();
  }
 else   if (requestCode == REPORT_ERROR) {
    showStartupScreensAndDialogs(AnkiDroidApp.getSharedPrefs(getBaseContext()),4);
  }
 else   if (requestCode == SHOW_INFO_UPGRADE_DECKS) {
    if (resultCode == RESULT_CANCELED) {
      finishWithAnimation();
    }
 else {
      showStartupScreensAndDialogs(AnkiDroidApp.getSharedPrefs(getBaseContext()),3);
    }
  }
 else   if (requestCode == SHOW_INFO_WELCOME || requestCode == SHOW_INFO_NEW_VERSION) {
    if (resultCode == RESULT_OK) {
      showStartupScreensAndDialogs(AnkiDroidApp.getSharedPrefs(getBaseContext()),requestCode == SHOW_INFO_WELCOME ? 1 : 2);
    }
 else {
      finishWithAnimation();
    }
  }
 else   if (requestCode == PREFERENCES_UPDATE) {
    String newLanguage=AnkiDroidApp.getSharedPrefs(this).getString("language","");
    if (!AnkiDroidApp.getLanguage().equals(newLanguage)) {
      AnkiDroidApp.setLanguage(newLanguage);
      mInvalidateMenu=true;
    }
    restorePreferences();
  }
 else   if (requestCode == REPORT_FEEDBACK && resultCode == RESULT_OK) {
  }
 else   if (requestCode == LOG_IN_FOR_SYNC && resultCode == RESULT_OK) {
    sync();
  }
 else   if (requestCode == LOG_IN_FOR_SHARED_DECK && resultCode == RESULT_OK) {
    addSharedDeck();
  }
 else   if (requestCode == ADD_SHARED_DECKS) {
    sync();
  }
 else   if (requestCode == REQUEST_REVIEW) {
    Log.i(AnkiDroidApp.TAG,"Result code = " + resultCode);
switch (resultCode) {
case Reviewer.RESULT_SESSION_COMPLETED:
default :
      loadCounts();
    break;
case Reviewer.RESULT_NO_MORE_CARDS:
  mDontSaveOnStop=true;
Intent i=new Intent();
i.setClass(this,StudyOptionsActivity.class);
i.putExtra("onlyFnsMsg",true);
startActivityForResult(i,SHOW_STUDYOPTIONS);
if (UIUtils.getApiLevel() > 4) {
ActivityTransitionAnimation.slide(this,ActivityTransitionAnimation.RIGHT);
}
break;
}
}
BroadcastMessages.showDialog();
}
