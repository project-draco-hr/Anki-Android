{
  if (skip < 1 && preferences.getLong("lastTimeOpened",0) == 0) {
    Intent infoIntent=new Intent(this,Info.class);
    infoIntent.putExtra(Info.TYPE_EXTRA,Info.TYPE_WELCOME);
    startActivityForResult(infoIntent,SHOW_INFO_WELCOME);
    if (skip != 0 && AnkiDroidApp.SDK_VERSION > 4) {
      ActivityTransitionAnimation.slide(this,ActivityTransitionAnimation.LEFT);
    }
  }
 else   if (skip < 2 && !preferences.getString("lastVersion","").equals(AnkiDroidApp.getPkgVersion())) {
    preferences.edit().putBoolean("showBroadcastMessageToday",true).commit();
    Intent infoIntent=new Intent(this,Info.class);
    infoIntent.putExtra(Info.TYPE_EXTRA,Info.TYPE_NEW_VERSION);
    startActivityForResult(infoIntent,SHOW_INFO_NEW_VERSION);
    if (skip != 0 && AnkiDroidApp.SDK_VERSION > 4) {
      ActivityTransitionAnimation.slide(this,ActivityTransitionAnimation.LEFT);
    }
  }
 else   if (skip < 3 && upgradeNeeded()) {
    AnkiDroidApp.getSharedPrefs(AnkiDroidApp.getInstance().getBaseContext()).edit().putString("lastUpgradeVersion",AnkiDroidApp.getPkgVersion()).commit();
    showUpgradeScreen(skip != 0,Info.UPGRADE_SCREEN_BASIC1);
  }
 else   if (skip < 4 && hasErrorFiles()) {
    Intent i=new Intent(this,Feedback.class);
    startActivityForResult(i,REPORT_ERROR);
    if (skip != 0 && AnkiDroidApp.SDK_VERSION > 4) {
      ActivityTransitionAnimation.slide(this,ActivityTransitionAnimation.LEFT);
    }
  }
 else   if (!AnkiDroidApp.isSdCardMounted()) {
    showDialog(DIALOG_SD_CARD_NOT_MOUNTED);
  }
 else   if (!BackupManager.enoughDiscSpace(mPrefDeckPath)) {
    showDialog(DIALOG_NO_SPACE_LEFT);
  }
 else   if (preferences.getBoolean("noSpaceLeft",false)) {
    showDialog(DIALOG_BACKUP_NO_SPACE_LEFT);
    preferences.edit().putBoolean("noSpaceLeft",false).commit();
  }
 else   if (mImportPath != null && AnkiDroidApp.colIsOpen()) {
    showDialog(DIALOG_IMPORT);
  }
 else {
    if (!preferences.getString("lastUpgradeVersion","").equals(AnkiDroidApp.getPkgVersion()) && (new File(AnkiDroidApp.getCurrentAnkiDroidDirectory()).listFiles(new OldAnkiDeckFilter()).length) > 0) {
      StyledDialog.Builder builder=new StyledDialog.Builder(DeckPicker.this);
      builder.setTitle(R.string.deck_upgrade_title);
      builder.setIcon(R.drawable.ic_dialog_alert);
      builder.setMessage(R.string.deck_upgrade_already_upgraded);
      builder.setPositiveButton(R.string.restart,new DialogInterface.OnClickListener(){
        @Override public void onClick(        DialogInterface dialog,        int which){
          restartUpgradeProcess();
        }
      }
);
      builder.setCancelable(false);
      builder.setNegativeButton(R.string.do_nothing,new DialogInterface.OnClickListener(){
        @Override public void onClick(        DialogInterface dialog,        int which){
          AnkiDroidApp.getSharedPrefs(AnkiDroidApp.getInstance().getBaseContext()).edit().putString("lastUpgradeVersion",AnkiDroidApp.getPkgVersion()).commit();
          loadCollection();
        }
      }
);
      builder.show();
    }
 else {
      loadCollection();
    }
  }
}
