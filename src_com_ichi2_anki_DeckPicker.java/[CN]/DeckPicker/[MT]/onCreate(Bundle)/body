{
  Log.i(TAG,"DeckPicker - onCreate");
  super.onCreate(savedInstanceState);
  restorePreferences();
  if (notificationBar == false) {
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,WindowManager.LayoutParams.FLAG_FULLSCREEN);
  }
  registerExternalStorageListener();
  mSelf=this;
  SharedPreferences preferences=PrefSettings.getSharedPrefs(getBaseContext());
  String deckPath=preferences.getString("deckPath",AnkiDroidApp.getStorageDirectory());
  setContentView(R.layout.main);
  mDeckList=new ArrayList<HashMap<String,String>>();
  mDeckListView=(ListView)findViewById(R.id.files);
  mDeckListAdapter=new SimpleAdapter(this,mDeckList,R.layout.deck_picker_list,new String[]{"name","due","new","showProgress"},new int[]{R.id.DeckPickerName,R.id.DeckPickerDue,R.id.DeckPickerNew,R.id.DeckPickerProgress});
  mDeckListAdapter.setViewBinder(new SimpleAdapter.ViewBinder(){
    public boolean setViewValue(    View view,    Object data,    String text){
      if (view instanceof ProgressBar) {
        if (text.equals("true"))         view.setVisibility(View.VISIBLE);
 else         view.setVisibility(View.GONE);
        return true;
      }
      return false;
    }
  }
);
  mDeckListView.setOnItemClickListener(mDeckSelHandler);
  mDeckListView.setAdapter(mDeckListAdapter);
  populateDeckList(deckPath);
}
