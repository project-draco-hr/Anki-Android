{
  mToolbar.inflateMenu(R.menu.study_options_fragment);
  mToolbar.setOnMenuItemClickListener(this);
  Menu menu=mToolbar.getMenu();
  if (getCol().getDecks().isDyn(getCol().getDecks().selected())) {
    menu.findItem(R.id.action_rebuild).setVisible(true);
    menu.findItem(R.id.action_empty).setVisible(true);
    menu.findItem(R.id.action_custom_study).setVisible(false);
  }
 else {
    menu.findItem(R.id.action_rebuild).setVisible(false);
    menu.findItem(R.id.action_empty).setVisible(false);
    menu.findItem(R.id.action_custom_study).setVisible(true);
  }
  menu.findItem(R.id.action_unbury).setVisible(getCol().getSched().haveBuried());
  if (!getCol().undoAvailable()) {
    menu.findItem(R.id.action_undo).setVisible(false);
  }
 else {
    menu.findItem(R.id.action_undo).setVisible(true);
    Resources res=AnkiDroidApp.getAppResources();
    menu.findItem(R.id.action_undo).setTitle(res.getString(R.string.studyoptions_congrats_undo,getCol().undoName(res)));
  }
  if (!mFragmented) {
    mToolbar.setNavigationIcon(new IconicsDrawable(getContext()).icon(GoogleMaterial.Icon.gmd_arrow_back).color(Color.WHITE).sizeDp(16));
    mToolbar.setNavigationOnClickListener(new View.OnClickListener(){
      @Override public void onClick(      View v){
        ((AnkiActivity)getActivity()).finishWithAnimation(ActivityTransitionAnimation.RIGHT);
      }
    }
);
  }
}
