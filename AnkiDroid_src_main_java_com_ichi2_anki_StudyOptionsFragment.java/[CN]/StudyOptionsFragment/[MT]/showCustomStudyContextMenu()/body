{
  Resources res=getResources();
  Drawable icon=res.getDrawable(R.drawable.ic_sort_black_36dp);
  icon.setAlpha(Themes.ALPHA_ICON_ENABLED_DARK);
  MaterialDialog dialog=new MaterialDialog.Builder(this.getActivity()).title(res.getString(R.string.custom_study)).icon(icon).cancelable(true).items(res.getStringArray(R.array.custom_study_options_labels)).itemsCallback(new MaterialDialog.ListCallback(){
    @Override public void onSelection(    MaterialDialog materialDialog,    View view,    int which,    CharSequence charSequence){
      DialogFragment dialogFragment;
      if (which == CustomStudyDialog.CUSTOM_STUDY_TAGS) {
        dialogFragment=com.ichi2.anki.dialogs.TagsDialog.newInstance(TagsDialog.TYPE_CUSTOM_STUDY_TAGS,new ArrayList<String>(),new ArrayList<String>(getCol().getTags().all()));
        ((TagsDialog)dialogFragment).setTagsDialogListener(new TagsDialogListener(){
          @Override public void onPositive(          List<String> selectedTags,          int option){
            StringBuilder sb=new StringBuilder();
switch (option) {
case 1:
              sb.append("is:new ");
            break;
case 2:
          sb.append("is:due ");
        break;
default :
      break;
  }
  int i=0;
  for (  String tag : selectedTags) {
    if (i != 0) {
      sb.append("or ");
    }
 else {
      sb.append("(");
    }
    sb.append("tag:").append(tag).append(" ");
    i++;
  }
  if (i > 0) {
    sb.append(")");
  }
  mSearchTerms=sb.toString();
  createFilteredDeck(new JSONArray(),new Object[]{mSearchTerms,Consts.DYN_MAX_SIZE,Consts.DYN_RANDOM},false);
}
}
);
}
 else {
dialogFragment=CustomStudyDialog.newInstance(which);
}
((AnkiActivity)getActivity()).showDialogFragment(dialogFragment);
}
}
).build();
dialog.setOwnerActivity(getActivity());
dialog.show();
}
