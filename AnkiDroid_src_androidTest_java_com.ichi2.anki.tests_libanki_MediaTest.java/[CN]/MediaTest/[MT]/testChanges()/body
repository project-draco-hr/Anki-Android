{
  Collection d=Shared.getEmptyCol(getContext());
  assertTrue(d.getMedia()._changed() != null);
  assertTrue(added(d).size() == 0);
  assertTrue(removed(d).size() == 0);
  File dir=Shared.getTestDir(getContext());
  File path=new File(dir,"foo.jpg");
  FileOutputStream os;
  os=new FileOutputStream(path,false);
  os.write("hello".getBytes());
  os.close();
  path=new File(d.getMedia().dir(),d.getMedia().addFile(path));
  d.getMedia().findChanges();
  assertTrue(added(d).size() > 0);
  assertTrue(removed(d).size() == 0);
  os=new FileOutputStream(path,true);
  os.write("world".getBytes());
  os.close();
  assertTrue(added(d).size() == 1);
  assertTrue(removed(d).size() == 0);
  path=new File(path.getAbsolutePath() + "2");
  os=new FileOutputStream(path,true);
  os.write("yo".getBytes());
  os.close();
  d.getMedia().findChanges(true);
  assertTrue(added(d).size() == 2);
  assertTrue(removed(d).size() == 0);
  path.delete();
  d.getMedia().findChanges(true);
  assertTrue(added(d).size() == 1);
  assertTrue(removed(d).size() == 1);
}
