{
  String username=(String)data.data[0];
  String password=(String)data.data[1];
  HttpSyncer server=new RemoteServer(this,null);
  HttpResponse ret;
  try {
    ret=server.register(username,password);
  }
 catch (  UnknownHttpResponseException e) {
    data.success=false;
    data.result=new Object[]{"error",e.getResponseCode(),e.getMessage()};
    return data;
  }
  String hostkey=null;
  boolean valid=false;
  String status=null;
  if (ret != null) {
    data.returnType=ret.getStatusLine().getStatusCode();
    if (data.returnType == 200) {
      try {
        JSONObject jo=(new JSONObject(server.stream2String(ret.getEntity().getContent())));
        status=jo.getString("status");
        if (status.equals("ok")) {
          hostkey=jo.getString("hkey");
          valid=(hostkey != null) && (hostkey.length() > 0);
        }
      }
 catch (      JSONException e) {
      }
catch (      IllegalStateException e) {
        throw new RuntimeException(e);
      }
catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
  }
  if (valid) {
    data.success=true;
    data.data=new String[]{username,hostkey};
  }
 else {
    data.success=false;
    data.data=new String[]{status != null ? status : AnkiDroidApp.getAppResources().getString(R.string.connection_error_message)};
  }
  return data;
}
