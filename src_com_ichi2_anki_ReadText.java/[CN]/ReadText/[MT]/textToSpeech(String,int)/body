{
  mTextToSpeak=text;
  mQuestionAnswer=qa;
  String language=getLanguage(mQuestionAnswer);
  if (availableTtsLocales.isEmpty()) {
    Locale[] systemLocales=Locale.getAvailableLocales();
    for (    Locale loc : systemLocales) {
      if (mTts.isLanguageAvailable(loc) == TextToSpeech.LANG_COUNTRY_AVAILABLE) {
        availableTtsLocales.add(new String[]{loc.getISO3Language(),loc.getDisplayName()});
      }
    }
  }
  for (int i=0; i < availableTtsLocales.size(); i++) {
    if (language.equals(NO_TTS)) {
      return;
    }
 else     if (language.equals(availableTtsLocales.get(i)[0])) {
      speak(language);
      return;
    }
  }
  Resources res=mReviewer.getResources();
  AlertDialog.Builder builder=new AlertDialog.Builder(mReviewer);
  if (availableTtsLocales.size() == 0) {
    builder.setTitle(res.getString(R.string.no_tts_available_title));
    builder.setMessage(res.getString(R.string.no_tts_available_message));
    builder.setIcon(android.R.drawable.ic_dialog_alert);
    builder.setPositiveButton(res.getString(R.string.ok),null);
  }
 else {
    ArrayList<CharSequence> dialogItems=new ArrayList<CharSequence>();
    final ArrayList<String> dialogIds=new ArrayList<String>();
    builder.setTitle(R.string.select_locale_title);
    dialogItems.add(res.getString(R.string.tts_no_tts));
    dialogIds.add(NO_TTS);
    for (int i=0; i < availableTtsLocales.size(); i++) {
      dialogItems.add(availableTtsLocales.get(i)[1]);
      dialogIds.add(availableTtsLocales.get(i)[0]);
    }
    CharSequence[] items=new CharSequence[dialogItems.size()];
    dialogItems.toArray(items);
    builder.setItems(items,new DialogInterface.OnClickListener(){
      @Override public void onClick(      DialogInterface dialog,      int which){
        MetaDB.storeLanguage(mReviewer,mDeckFilename,mModelId,mTemplate,mQuestionAnswer,dialogIds.get(which));
        speak(dialogIds.get(which));
      }
    }
);
  }
  AlertDialog alert=builder.create();
  alert.show();
}
