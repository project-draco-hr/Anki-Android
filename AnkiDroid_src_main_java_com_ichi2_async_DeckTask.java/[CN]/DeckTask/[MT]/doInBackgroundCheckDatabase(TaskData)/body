{
  Timber.d("doInBackgroundCheckDatabase");
  Collection col=params[0].getCollection();
  if (!AnkiDroidApp.colIsOpen()) {
    Timber.e("doInBackgroundCheckDatabase :: collection not open, trying to reload");
    AnkiDroidApp.openCollection(AnkiDroidApp.COLLECTION_PATH);
    col=AnkiDroidApp.getCol();
    if (col == null) {
      Timber.e("doInBackgroundCheckDatabase :: collection reload failed");
      return new TaskData(false);
    }
  }
  long result=col.fixIntegrity();
  if (result == -1) {
    return new TaskData(false);
  }
 else {
    AnkiDroidApp.closeCollection(true);
    return new TaskData(0,result,true);
  }
}
