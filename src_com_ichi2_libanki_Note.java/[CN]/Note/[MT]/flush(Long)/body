{
  _preFlush();
  String sfld=Utils.stripHTMLMedia(mFields[mCol.getModels().sortIdx(mModel)]);
  String tags=stringTags();
  String fields=joinedFields();
  if (mod == null && mCol.getDb().queryScalar(String.format(Locale.US,"select 1 from notes where id = ? and tags = ? and flds = ?",mId,tags,fields),false) > 0) {
    return;
  }
  long csum=Utils.fieldChecksum(mFields[0]);
  mMod=mod != null ? mod : Utils.intNow();
  mUsn=mCol.usn();
  mCol.getDb().execute("INSERT OR REPLACE INTO notes VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",new Object[]{mId,mGuId,mMid,mMod,mUsn,tags,fields,sfld,csum,mFlags,mData});
  mCol.getTags().register(mTags);
  _postFlush();
}
