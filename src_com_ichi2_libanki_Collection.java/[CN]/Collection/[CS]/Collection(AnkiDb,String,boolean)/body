{
  mDb=db;
  mServer=server;
  mLastSave=Utils.now();
  clearUndo();
  mPath=path;
  mMedia=new Media(this);
  mModels=new Models(this);
  mDecks=new Decks(this);
  mTags=new Tags(this);
  load();
  if (mCrt == 0) {
    Calendar cal=GregorianCalendar.getInstance();
    if (cal.get(Calendar.HOUR_OF_DAY) < 4) {
      cal.roll(Calendar.DAY_OF_YEAR,-1);
    }
    cal.set(Calendar.HOUR_OF_DAY,4);
    cal.set(Calendar.MINUTE,0);
    cal.set(Calendar.SECOND,0);
    cal.set(Calendar.MILLISECOND,0);
    mCrt=cal.getTimeInMillis() / 1000;
  }
  mUndoEnabled=false;
  mSessionStartReps=0;
  mSessionStartTime=0;
  mLastSessionStart=0;
  mStdSched=new Sched(this);
  mSched=mStdSched;
  cleanup();
}
