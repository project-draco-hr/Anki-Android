{
  Log.i(AnkiDroidApp.TAG,"doInBackgroundOpenCollection");
  Resources res=AnkiDroidApp.getInstance().getBaseContext().getResources();
  String collectionFile=params[0].getString();
  Collection oldCol=Collection.currentCollection();
  Collection col=null;
  publishProgress(new TaskData(res.getString(R.string.open_collection)));
  if (oldCol == null || !oldCol.getPath().equals(collectionFile)) {
    if (BackupManager.safetyBackupNeeded(collectionFile)) {
      publishProgress(new TaskData(res.getString(R.string.backup_collection)));
      BackupManager.performBackup(collectionFile);
    }
    publishProgress(new TaskData(res.getString(R.string.open_collection)));
    try {
      col=Collection.openCollection(collectionFile);
    }
 catch (    RuntimeException e) {
      BackupManager.restoreCollectionIfMissing(collectionFile);
      Log.e(AnkiDroidApp.TAG,"doInBackgroundOpenCollection - RuntimeException on opening collection: " + e);
      AnkiDroidApp.saveExceptionReportFile(e,"doInBackgroundOpenCollection");
      return new TaskData(false);
    }
    SharedPreferences prefs=AnkiDroidApp.getSharedPrefs(AnkiDroidApp.getInstance().getBaseContext());
    if (prefs.contains("createTutorial") && prefs.getBoolean("createTutorial",false)) {
      prefs.edit().remove("createTutorial").commit();
      publishProgress(new TaskData(res.getString(R.string.tutorial_load)));
      doInBackgroundLoadTutorial(new TaskData(col));
    }
  }
 else {
    Log.i(AnkiDroidApp.TAG,"doInBackgroundOpenCollection: collection still open - reusing it");
    col=oldCol;
  }
  return new TaskData(col,doInBackgroundLoadDeckCounts(new TaskData(col)).getObjArray());
}
