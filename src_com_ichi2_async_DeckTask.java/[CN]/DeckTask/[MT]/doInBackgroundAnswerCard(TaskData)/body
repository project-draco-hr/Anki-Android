{
  Sched sched=params[0].getSched();
  Card oldCard=params[0].getCard();
  int ease=params[0].getInt();
  Card newCard=null;
  int oldCardLeech=0;
  AnkiDb ankiDB=sched.getCol().getDb();
  ankiDB.getDatabase().beginTransaction();
  try {
    if (oldCard != null) {
      oldCardLeech=sched.answerCard(oldCard,ease) ? 1 : 0;
      if (oldCardLeech != 0) {
        oldCardLeech+=sched.leechActionSuspend(oldCard) ? 1 : 0;
      }
    }
    if (newCard == null) {
      newCard=sched.getCard();
    }
    if (newCard != null) {
      newCard._getQA(true);
    }
    publishProgress(new TaskData(newCard,oldCardLeech));
    ankiDB.getDatabase().setTransactionSuccessful();
  }
  finally {
    ankiDB.getDatabase().endTransaction();
  }
  return new TaskData(true);
}
