{
  mMediaDb.getDatabase().beginTransaction();
  try {
    for (int i=0; i < fnames.length(); ++i) {
      String f=fnames.optString(i);
      if (f == "") {
        continue;
      }
      File file=new File(getDir(),f);
      if (file.exists()) {
        file.delete();
      }
      mMediaDb.execute("delete from log where fname = ?",new String[]{f});
      mMediaDb.execute("delete from media where fname = ?",new String[]{f});
    }
    mMediaDb.execute("delete from log where type = ?",new String[]{Integer.toString(MEDIA_REM)});
    mMediaDb.getDatabase().setTransactionSuccessful();
  }
  finally {
    mMediaDb.getDatabase().endTransaction();
  }
}
