{
  Deck deck=AnkiDroidApp.deck();
  Resources res=getResources();
  DeckTask.waitToFinish();
  if (deck != null) {
    deck.reset();
    int dueCount=deck.getDueCount();
    int cardsCount=deck.getCardCount();
    setTitle(res.getQuantityString(R.plurals.studyoptions_window_title,dueCount,deck.getDeckName(),dueCount,cardsCount));
    mTextDeckName.setText(deck.getDeckName());
    mTextReviewsDue.setText(String.valueOf(dueCount));
    mTextNewToday.setText(String.valueOf(deck.getNewCountToday()));
    String etastr="-";
    int eta=(int)deck.getStats(Stats.TYPE_ETA)[0];
    if (eta != -1) {
      etastr=Integer.toString(eta / 60);
    }
    mTextETA.setText(etastr);
    int totalNewCount=deck.getNewCount(false);
    mTextNewTotal.setText(String.valueOf(totalNewCount));
    if (mDailyBar != null) {
      double[] values=deck.getStats(Stats.TYPE_YES_SHARES);
      double totalCardsCount=cardsCount;
      mProgressTodayYes=values[0];
      mProgressMatureYes=values[1];
      double mature=deck.getMatureCardCount(false);
      mProgressMature=mature / totalCardsCount;
      double allRev=deck.getTotalRevFailedCount(false);
      mProgressAll=allRev / totalCardsCount;
      if (deck.isLimitedByTag()) {
        if (mToggleCram.isChecked()) {
          mGlobalLimitFrame.setVisibility(View.GONE);
        }
 else {
          mGlobalLimitFrame.setVisibility(View.VISIBLE);
          mature=deck.getMatureCardCount(true);
          allRev=deck.getTotalRevFailedCount(true);
          totalCardsCount=allRev + deck.getNewCount(true);
          mProgressMatureLimit=mature / totalCardsCount;
          mProgressAllLimit=allRev / totalCardsCount;
        }
      }
 else {
        mGlobalLimitFrame.setVisibility(View.GONE);
      }
      updateStatisticBars();
    }
  }
}
