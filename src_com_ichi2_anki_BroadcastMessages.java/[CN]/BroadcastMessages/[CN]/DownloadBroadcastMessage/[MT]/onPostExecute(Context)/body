{
  Log.d(AnkiDroidApp.TAG,"BroadcastMessage.DownloadBroadcastMessage.onPostExecute()");
  if (!mShowDialog) {
    return;
  }
  StyledDialog.Builder builder=new StyledDialog.Builder(context);
  Resources res=context.getResources();
  if (mText != null && mText.length() > 0) {
    WebView view=new WebView(context);
    view.setBackgroundColor(res.getColor(Themes.getDialogBackgroundColor()));
    view.loadDataWithBaseURL("","<html><body text=\"#000000\" link=\"#E37068\" alink=\"#E37068\" vlink=\"#E37068\">" + mText + "<br></body></html>","text/html","UTF-8","");
    builder.setView(view,true);
    builder.setCancelable(true);
    builder.setNegativeButton(res.getString(R.string.close),new DialogInterface.OnClickListener(){
      @Override public void onClick(      DialogInterface dialog,      int which){
        setMessageRead(mActivity,mNum);
        BroadcastMessages.checkForNewMessages(mActivity);
      }
    }
);
  }
 else {
    return;
  }
  if (mTitle != null && mTitle.length() > 0) {
    builder.setTitle(mTitle);
  }
  if (mUrl != null && mUrl.length() > 0) {
    builder.setPositiveButton(mUrl.substring(mUrl.length() - 4).equals(".apk") ? res.getString(R.string.download) : res.getString(R.string.visit),new DialogInterface.OnClickListener(){
      @Override public void onClick(      DialogInterface dialog,      int which){
        setMessageRead(mActivity,mNum);
        String action="android.intent.action.VIEW";
        if (Utils.isIntentAvailable(mActivity,action)) {
          Intent i=new Intent(action,Uri.parse(mUrl));
          mActivity.startActivity(i);
        }
      }
    }
);
    builder.setNeutralButton(res.getString(R.string.later),null);
  }
  try {
    mDialog=builder.create();
    Log.d(AnkiDroidApp.TAG,"BroadcastMessages: show dialog");
    mDialog.setOwnerActivity(mActivity);
    mDialog.show();
  }
 catch (  BadTokenException e) {
    Log.e(AnkiDroidApp.TAG,"BroadcastMessage - BadTokenException on showing dialog: " + e);
  }
}
