{
  Log.i(AnkiDroidApp.TAG,"bundleStats");
  JSONObject bundledStats=new JSONObject();
  Date lastDay=new Date(java.lang.Math.max(0,(long)(mDeck.getLastSync() - 60 * 60 * 24) * 1000));
  Log.i(AnkiDroidApp.TAG,"lastDay = " + lastDay.toString());
  ArrayList<Long> ids=mDeck.getDB().queryColumn(Long.class,"SELECT id FROM stats WHERE type = 1 and day >= \"" + lastDay.toString() + "\"",0);
  Stats stat=new Stats(mDeck);
  bundledStats.put("global",Stats.globalStats(mDeck).bundleJson());
  JSONArray dailyStats=new JSONArray();
  if (ids != null) {
    for (    Long id : ids) {
      stat.fromDB(id);
      dailyStats.put(stat.bundleJson());
    }
  }
  bundledStats.put("daily",dailyStats);
  Log.i(AnkiDroidApp.TAG,"Stats =");
  Utils.printJSONObject(bundledStats,false);
  return bundledStats;
}
