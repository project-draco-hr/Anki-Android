{
  JSONArray locallyEdited=new JSONArray();
  JSONArray locallyDeleted=new JSONArray();
  JSONArray remotelyEdited=new JSONArray();
  JSONArray remotelyDeleted=new JSONArray();
  Utils.printJSONObject(summaryLocal,false);
  Utils.printJSONObject(summaryServer,false);
  HashSet<Long> ids=new HashSet<Long>();
  HashMap<Long,Double> remoteMod=new HashMap<Long,Double>();
  putExistingItems(ids,remoteMod,summaryServer.getJSONArray(key));
  HashMap<Long,Double> rdeletedIds=putDeletedItems(ids,remoteMod,summaryServer.getJSONArray("del" + key));
  HashMap<Long,Double> localMod=new HashMap<Long,Double>();
  putExistingItems(ids,localMod,summaryLocal.getJSONArray(key));
  HashMap<Long,Double> ldeletedIds=putDeletedItems(ids,localMod,summaryLocal.getJSONArray("del" + key));
  Iterator<Long> idsIterator=ids.iterator();
  while (idsIterator.hasNext()) {
    Long id=idsIterator.next();
    Double localModTime=localMod.get(id);
    Double remoteModTime=remoteMod.get(id);
    if (localModTime != null && remoteModTime != null) {
      if (localModTime < remoteModTime) {
        remotelyEdited.put(id);
      }
 else       if (localModTime > remoteModTime) {
        locallyEdited.put(id);
      }
    }
 else     if (localModTime != null && remoteModTime == null) {
      if (!rdeletedIds.containsKey(id) || rdeletedIds.get(id) < localModTime) {
        locallyEdited.put(id);
      }
 else {
        remotelyDeleted.put(id);
      }
    }
 else     if (remoteModTime != null && localModTime == null) {
      if (!ldeletedIds.containsKey(id) || ldeletedIds.get(id) < remoteModTime) {
        remotelyEdited.put(id);
      }
 else {
        locallyDeleted.put(id);
      }
    }
 else {
      if (ldeletedIds.containsKey(id) && !rdeletedIds.containsKey(id)) {
        locallyDeleted.put(id);
      }
 else       if (rdeletedIds.containsKey(id) && !ldeletedIds.containsKey(id)) {
        remotelyDeleted.put(id);
      }
    }
  }
  JSONArray diff=new JSONArray();
  diff.put(locallyEdited);
  diff.put(locallyDeleted);
  diff.put(remotelyEdited);
  diff.put(remotelyDeleted);
  return diff;
}
