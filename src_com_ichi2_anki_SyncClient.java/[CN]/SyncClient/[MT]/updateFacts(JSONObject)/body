{
  try {
    AnkiDb ankiDB=AnkiDatabaseManager.getDatabase(mDeck.getDeckPath());
    JSONArray facts=factsDict.getJSONArray("facts");
    int lenFacts=facts.length();
    if (lenFacts > 0) {
      JSONArray fields=factsDict.getJSONArray("fields");
      int lenFields=fields.length();
      ArrayList<String> factIds=new ArrayList<String>();
      for (int i=0; i < lenFacts; i++) {
        factIds.add(facts.getJSONArray(i).getString(0));
      }
      String factIdsString=Utils.ids2str(factIds);
      String sqlFact="INSERT OR REPLACE INTO facts (id, modelId, created, modified, tags, spaceUntil, lastCardId)" + " VALUES(?,?,?,?,?,?,?)";
      SQLiteStatement statement=ankiDB.getDatabase().compileStatement(sqlFact);
      for (int i=0; i < lenFacts; i++) {
        JSONArray fact=facts.getJSONArray(i);
        statement.bindLong(1,fact.getLong(0));
        statement.bindLong(2,fact.getLong(1));
        statement.bindDouble(3,fact.getDouble(2));
        statement.bindDouble(4,fact.getDouble(3));
        statement.bindString(5,fact.getString(4));
        if (fact.getString(5) == null) {
          statement.bindString(6,"");
        }
 else {
          statement.bindString(6,fact.getString(5));
        }
        if (!fact.isNull(6)) {
          statement.bindLong(7,fact.getLong(6));
        }
 else {
          statement.bindNull(7);
        }
        statement.execute();
      }
      statement.close();
      ankiDB.getDatabase().execSQL("DELETE FROM fields WHERE factId IN " + factIdsString);
      String sqlFields="INSERT INTO fields (id, factId, fieldModelId, ordinal, value) VALUES(?,?,?,?,?)";
      statement=ankiDB.getDatabase().compileStatement(sqlFields);
      for (int i=0; i < lenFields; i++) {
        JSONArray field=fields.getJSONArray(i);
        statement.bindLong(1,field.getLong(0));
        statement.bindLong(2,field.getLong(1));
        statement.bindLong(3,field.getLong(2));
        statement.bindString(4,field.getString(3));
        statement.bindString(5,field.getString(4));
        statement.execute();
      }
      statement.close();
      ankiDB.getDatabase().execSQL("DELETE FROM factsDeleted WHERE factId IN " + factIdsString);
    }
  }
 catch (  JSONException e) {
    Log.i(AnkiDroidApp.TAG,"JSONException = " + e.getMessage());
  }
}
