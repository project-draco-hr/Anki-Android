{
  JSONObject bundledDeck=new JSONObject();
  if ((mServer != null) && (mServer.getTimestamp() != 0.0)) {
    mDeck.setModified(Math.min(mDeck.getModified(),mServer.getTimestamp()));
  }
  mDeck.setLastSync(Math.max(Utils.now(),mDeck.getModified() + 1));
  try {
    bundledDeck=mDeck.bundleJson(bundledDeck);
    JSONArray meta=new JSONArray();
    Cursor cursor=AnkiDatabaseManager.getDatabase(mDeck.getDeckPath()).getDatabase().rawQuery("SELECT * FROM deckVars",null);
    while (cursor.moveToNext()) {
      JSONArray deckVar=new JSONArray();
      deckVar.put(cursor.getString(0));
      deckVar.put(cursor.getString(1));
      meta.put(deckVar);
    }
    cursor.close();
    bundledDeck.put("meta",meta);
  }
 catch (  JSONException e) {
    Log.i(AnkiDroidApp.TAG,"JSONException = " + e.getMessage());
  }
  Log.i(AnkiDroidApp.TAG,"Deck =");
  Utils.printJSONObject(bundledDeck,false);
  return bundledDeck;
}
