{
  View row=convertView;
  DownloadViewWrapper wrapper=null;
  Resources res=getResources();
  if (row == null) {
    row=getLayoutInflater().inflate(R.layout.download_deck_item,null);
    wrapper=new DownloadViewWrapper(row);
    row.setTag(wrapper);
  }
 else {
    wrapper=(DownloadViewWrapper)row.getTag();
  }
  TextView headerTitle=wrapper.getHeaderTitle();
  TextView downloadingSharedDeckTitle=wrapper.getDownloadTitle();
  ProgressBar progressBar=wrapper.getProgressBar();
  TextView progressText=wrapper.getProgressBarText();
  TextView sharedDeckTitle=wrapper.getDeckTitle();
  TextView sharedDeckFacts=wrapper.getDeckFacts();
  Object obj=(Object)mAllSharedDecks.get(position);
  if (obj instanceof Download) {
    Download download=(Download)obj;
    sharedDeckTitle.setVisibility(View.GONE);
    sharedDeckFacts.setVisibility(View.GONE);
    if (position == 0) {
      headerTitle.setText(res.getString(R.string.currently_downloading));
      headerTitle.setVisibility(View.VISIBLE);
    }
 else {
      headerTitle.setVisibility(View.GONE);
    }
    downloadingSharedDeckTitle.setText(download.getTitle());
    downloadingSharedDeckTitle.setVisibility(View.VISIBLE);
    progressBar.setVisibility(View.VISIBLE);
switch (download.getStatus()) {
case Download.START:
      progressText.setText(res.getString(R.string.starting_download));
    progressBar.setProgress(0);
  break;
case Download.DOWNLOADING:
progressText.setText(res.getString(R.string.downloading));
progressBar.setProgress(download.getProgress());
break;
case Download.PAUSED:
progressText.setText(res.getString(R.string.paused));
break;
case Download.COMPLETE:
progressText.setText(res.getString(R.string.downloaded));
progressBar.setProgress(0);
break;
case SharedDeckDownload.UPDATE:
progressText.setText(res.getString(R.string.updating));
if (download instanceof SharedDeckDownload) {
Log.i(TAG,"Updating shared download view, progress = " + download.getProgress());
progressBar.setProgress(((SharedDeckDownload)download).getProgress());
}
break;
default :
progressText.setText(res.getString(R.string.error));
break;
}
progressText.setVisibility(View.VISIBLE);
}
 else {
SharedDeck sharedDeck=(SharedDeck)obj;
if (position > 0 && (mAllSharedDecks.get(position - 1) instanceof Download)) {
headerTitle.setText(res.getString(R.string.shared_decks));
headerTitle.setVisibility(View.VISIBLE);
}
 else {
headerTitle.setVisibility(View.GONE);
}
downloadingSharedDeckTitle.setVisibility(View.GONE);
progressBar.setVisibility(View.GONE);
progressText.setVisibility(View.GONE);
sharedDeckTitle.setText(sharedDeck.getTitle());
sharedDeckTitle.setVisibility(View.VISIBLE);
int numFacts=sharedDeck.getFacts();
if (numFacts == 1) {
sharedDeckFacts.setText(numFacts + " " + res.getString(R.string.fact));
}
 else {
sharedDeckFacts.setText(numFacts + " " + res.getString(R.string.facts));
}
sharedDeckFacts.setVisibility(View.VISIBLE);
}
return row;
}
