{
  View row=convertView;
  DownloadViewWrapper wrapper=null;
  Resources res=getResources();
  if (row == null) {
    row=getLayoutInflater().inflate(R.layout.download_deck_item,null);
    wrapper=new DownloadViewWrapper(row);
    row.setTag(wrapper);
  }
 else {
    wrapper=(DownloadViewWrapper)row.getTag();
  }
  TextView headerTitle=wrapper.getHeaderTitle();
  TextView downloadingSharedDeckTitle=wrapper.getDownloadTitle();
  ProgressBar progressBar=wrapper.getProgressBar();
  TextView progressText=wrapper.getProgressBarText();
  TextView estimatedText=wrapper.getEstimatedTimeText();
  TextView sharedDeckTitle=wrapper.getDeckTitle();
  TextView sharedDeckFacts=wrapper.getDeckFacts();
  progressBar.setIndeterminate(false);
  Object obj=mAllSharedDecks.get(position);
  if (obj instanceof Download) {
    Download download=(Download)obj;
    sharedDeckTitle.setVisibility(View.GONE);
    sharedDeckFacts.setVisibility(View.GONE);
    if (position == 0) {
      headerTitle.setText(res.getString(R.string.currently_downloading));
      headerTitle.setVisibility(View.VISIBLE);
    }
 else {
      headerTitle.setVisibility(View.GONE);
    }
    downloadingSharedDeckTitle.setText(download.getTitle());
    downloadingSharedDeckTitle.setVisibility(View.VISIBLE);
    progressBar.setVisibility(View.VISIBLE);
switch (download.getStatus()) {
case Download.STATUS_STARTED:
      progressText.setText(res.getString(R.string.starting_download));
    estimatedText.setText("");
  progressBar.setProgress(0);
break;
case Download.STATUS_DOWNLOADING:
progressText.setText(res.getString(R.string.downloading));
estimatedText.setText("");
progressBar.setProgress(download.getProgress());
break;
case Download.STATUS_PAUSED:
progressText.setText(res.getString(R.string.paused));
estimatedText.setText("");
progressBar.setProgress(download.getProgress());
break;
case Download.STATUS_COMPLETE:
progressText.setText(res.getString(R.string.downloaded));
estimatedText.setText("");
progressBar.setProgress(0);
break;
case SharedDeckDownload.STATUS_UPDATING:
progressText.setText(res.getString(R.string.updating));
estimatedText.setText(download.getEstTimeToCompletion());
progressBar.setProgress(download.getProgress());
break;
case Download.STATUS_CANCELLED:
progressText.setText(res.getString(R.string.cancelling));
estimatedText.setText("");
progressBar.setProgress(download.getProgress());
break;
default :
progressText.setText(res.getString(R.string.error));
estimatedText.setText("");
break;
}
progressText.setVisibility(View.VISIBLE);
estimatedText.setVisibility(View.VISIBLE);
}
 else {
SharedDeck sharedDeck=(SharedDeck)obj;
if (position > 0 && (mAllSharedDecks.get(position - 1) instanceof Download)) {
headerTitle.setText(res.getString(R.string.shared_decks));
headerTitle.setVisibility(View.VISIBLE);
}
 else {
headerTitle.setVisibility(View.GONE);
}
downloadingSharedDeckTitle.setVisibility(View.GONE);
progressBar.setVisibility(View.GONE);
progressText.setVisibility(View.GONE);
estimatedText.setVisibility(View.GONE);
sharedDeckTitle.setText(sharedDeck.getTitle());
sharedDeckTitle.setVisibility(View.VISIBLE);
int numFacts=sharedDeck.getFacts();
if (numFacts == 1) {
sharedDeckFacts.setText(numFacts + " " + res.getString(R.string.fact));
}
 else {
sharedDeckFacts.setText(numFacts + " " + res.getString(R.string.facts));
}
sharedDeckFacts.setVisibility(View.VISIBLE);
}
return row;
}
