{
  boolean notLimitedUp=true;
  boolean notLimitedBottom=true;
  boolean notLimitedLeft=true;
  boolean notLimitedRight=true;
  if (mChart instanceof XYChart) {
    int scales=mRenderer.getScalesCount();
    double[] limits=mRenderer.getPanLimits();
    boolean limited=limits != null && limits.length == 4;
    XYChart chart=(XYChart)mChart;
    for (int i=0; i < scales; i++) {
      double[] range=getRange(i);
      double[] calcRange=chart.getCalcRange(i);
      if (limitsReachedX && limitsReachedY && (range[0] == range[1] && calcRange[0] == calcRange[1] || range[2] == range[3] && calcRange[2] == calcRange[3])) {
        return;
      }
      checkRange(range,i);
      double[] realPoint=chart.toRealPoint(oldX,oldY,i);
      double[] realPoint2=chart.toRealPoint(newX,newY,i);
      double deltaX=realPoint[0] - realPoint2[0];
      double deltaY=realPoint[1] - realPoint2[1];
      double ratio=getAxisRatio(range);
      if (chart.isVertical(mRenderer)) {
        double newDeltaX=-deltaY * ratio;
        double newDeltaY=deltaX / ratio;
        deltaX=newDeltaX;
        deltaY=newDeltaY;
      }
      if (mRenderer.isPanXEnabled()) {
        if (limits != null) {
          if (notLimitedLeft) {
            notLimitedLeft=limits[0] <= range[0] + deltaX;
          }
          if (notLimitedRight) {
            notLimitedRight=limits[1] >= range[1] + deltaX;
          }
        }
        if (!limited || (notLimitedLeft && notLimitedRight)) {
          setXRange(range[0] + deltaX,range[1] + deltaX,i);
          limitsReachedX=false;
        }
 else {
          limitsReachedX=true;
        }
      }
      if (mRenderer.isPanYEnabled()) {
        if (notLimitedBottom && limits != null) {
          notLimitedBottom=limits[2] <= range[2] - deltaY;
        }
        if (notLimitedUp && limits != null) {
          notLimitedUp=limits[3] >= range[3] - deltaY;
        }
        if (limited && (!notLimitedBottom && !notLimitedUp)) {
          limitsReachedY=true;
        }
 else {
          if (!notLimitedUp && deltaY < 0) {
            setYRange(range[2] + deltaY,range[3] + deltaY,i);
            notLimitedUp=true;
          }
 else           if (!notLimitedBottom && deltaY > 0) {
            setYRange(range[2] + deltaY,range[3] + deltaY,i);
            notLimitedBottom=true;
          }
 else           if (notLimitedBottom && notLimitedUp) {
            setYRange(range[2] + deltaY,range[3] + deltaY,i);
          }
          limitsReachedY=false;
        }
      }
    }
  }
 else {
    RoundChart chart=(RoundChart)mChart;
    chart.setCenterX(chart.getCenterX() + (int)(newX - oldX));
    chart.setCenterY(chart.getCenterY() + (int)(newY - oldY));
  }
  notifyPanListeners();
}
