{
  Log.i(AnkiDroidApp.TAG,"deleteFieldModel, modelId = " + modelId + ", fieldModelId = "+ fieldModelId);
  getDB().delete(this,"fields","fieldModel = " + fieldModelId,null);
  getDB().getDatabase().execSQL("UPDATE facts SET modified = " + String.format(Utils.ENGLISH_LOCALE,"%f",Utils.now()) + " WHERE modelId = "+ modelId);
  String fieldName="";
  Cursor cursor=null;
  try {
    cursor=getDB().getDatabase().rawQuery("SELECT name FROM fieldModels WHERE id = " + fieldModelId,null);
    if (cursor.moveToNext()) {
      fieldName=cursor.getString(0);
    }
  }
  finally {
    if (cursor != null && !cursor.isClosed()) {
      cursor.close();
    }
  }
  SQLiteStatement statement=null;
  try {
    cursor=getDB().getDatabase().rawQuery("SELECT id, qformat, aformat FROM cardModels WHERE modelId = " + modelId,null);
    String sql="UPDATE cardModels SET qformat = ?, aformat = ? WHERE id = ?";
    statement=getDB().getDatabase().compileStatement(sql);
    while (cursor.moveToNext()) {
      String id=cursor.getString(0);
      String newQFormat=cursor.getString(1);
      String newAFormat=cursor.getString(2);
      newQFormat=newQFormat.replace("%%(" + fieldName + ")s","");
      newQFormat=newQFormat.replace("%%(text:" + fieldName + ")s","");
      newAFormat=newAFormat.replace("%%(" + fieldName + ")s","");
      newAFormat=newAFormat.replace("%%(text:" + fieldName + ")s","");
      statement.bindString(1,newQFormat);
      statement.bindString(2,newAFormat);
      statement.bindString(3,id);
      statement.execute();
    }
  }
  finally {
    if (cursor != null && !cursor.isClosed()) {
      cursor.close();
    }
  }
  statement.close();
  ContentValues values=new ContentValues();
  values.put("modified",String.format(Utils.ENGLISH_LOCALE,"%f",Utils.now()));
  getDB().update(this,"models",values,"id = " + modelId,null);
  flushMod();
}
