{
  try {
    mCardCount=(int)getDB().queryScalar("SELECT count(*) from cards");
    mFactCount=(int)getDB().queryScalar("SELECT count(*) from facts");
  }
 catch (  SQLException e) {
    Log.e(AnkiDroidApp.TAG,"rebuildCounts: Error while getting global counts: " + e.toString());
    mCardCount=0;
    mFactCount=0;
  }
  Cursor cursor=null;
  ArrayList<Long> cardIds=new ArrayList<Long>();
  try {
    cursor=getDB().getDatabase().rawQuery("SELECT count(), SUM(CASE WHEN rep = 1 THEN 1 ELSE 0 END) FROM revlog WHERE time > = " + mFailedCutoff + 86400,null);
    while (cursor.moveToNext()) {
      mRepsToday=cursor.getInt(0);
      mNewSeenToday=cursor.getInt(1);
    }
  }
 catch (  SQLException e) {
    Log.e(AnkiDroidApp.TAG,"rebuildCounts: Error while getting day counts: " + e.toString());
    mRepsToday=0;
    mNewSeenToday=0;
  }
 finally {
    if (cursor != null && !cursor.isClosed()) {
      cursor.close();
    }
  }
  rebuildFailedCount();
  rebuildRevCount();
  rebuildNewCount();
}
