{
  int icon;
  SharedPreferences preferences=AnkiDroidApp.getSharedPrefs(this);
  if (preferences.getBoolean("invertedColors",false)) {
    icon=R.drawable.ic_menu_night_checked;
  }
 else {
    icon=R.drawable.ic_menu_night;
  }
  mInvalidateMenu=false;
  UIUtils.addMenuItemInActionBar(menu,Menu.NONE,MENU_NIGHT,Menu.NONE,R.string.night_mode,icon);
  UIUtils.addMenuItem(menu,Menu.NONE,MENU_PREFERENCES,Menu.NONE,R.string.menu_preferences,R.drawable.ic_menu_preferences);
  UIUtils.addMenuItem(menu,Menu.NONE,MENU_ROTATE,Menu.NONE,R.string.menu_rotate,android.R.drawable.ic_menu_always_landscape_portrait);
  if (AnkiDroidApp.colIsOpen() && !AnkiDroidApp.getCol().getDecks().isDyn(AnkiDroidApp.getCol().getDecks().selected())) {
    UIUtils.addMenuItem(menu,Menu.NONE,DeckPicker.MENU_CREATE_DYNAMIC_DECK,Menu.NONE,R.string.studyoptions_new_filtercram,R.drawable.ic_menu_add);
  }
  return true;
}
