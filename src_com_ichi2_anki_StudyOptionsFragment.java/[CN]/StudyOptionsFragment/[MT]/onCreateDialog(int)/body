{
  StyledDialog dialog=null;
  Resources res=getResources();
  StyledDialog.Builder builder1=new StyledDialog.Builder(this.getActivity());
switch (id) {
case DIALOG_STATISTIC_TYPE:
    dialog=ChartBuilder.getStatisticsDialog(getActivity(),new DialogInterface.OnClickListener(){
      @Override public void onClick(      DialogInterface dialog,      int which){
        DeckTask.launchDeckTask(DeckTask.TASK_TYPE_LOAD_STATISTICS,mLoadStatisticsHandler,new DeckTask.TaskData(AnkiDroidApp.getCol(),which,false));
      }
    }
,mFragmented);
  break;
case DIALOG_CUSTOM_STUDY:
builder1.setTitle(res.getString(R.string.custom_study));
builder1.setIcon(android.R.drawable.ic_menu_sort_by_size);
builder1.setItems(res.getStringArray(R.array.custom_study_options_labels),new DialogInterface.OnClickListener(){
@Override public void onClick(DialogInterface dialog,int which){
StyledDialog.Builder builder2=new StyledDialog.Builder(StudyOptionsFragment.this.getActivity());
Resources res=getResources();
builder2.setTitle(res.getStringArray(R.array.custom_study_options_labels)[which]);
DialogInterface.OnClickListener listener=null;
switch (which + 1) {
case CUSTOM_STUDY_NEW:
  if (AnkiDroidApp.colIsOpen()) {
    Collection col=AnkiDroidApp.getCol();
    mCustomStudyTextView1.setText(res.getString(R.string.custom_study_new_total_new,col.getSched().totalNewForCurrentDeck()));
  }
mCustomStudyTextView2.setText(res.getString(R.string.custom_study_new_extend));
mCustomStudyEditText.setText(Integer.toString(AnkiDroidApp.getSharedPrefs(getActivity()).getInt("extendNew",10)));
listener=new DialogInterface.OnClickListener(){
@Override public void onClick(DialogInterface dialog,int which){
if (AnkiDroidApp.colIsOpen()) {
  try {
    int n=Integer.parseInt(mCustomStudyEditText.getText().toString());
    AnkiDroidApp.getSharedPrefs(getActivity()).edit().putInt("extendNew",n).commit();
    Collection col=AnkiDroidApp.getCol();
    JSONObject deck=col.getDecks().current();
    deck.put("extendNew",n);
    col.getDecks().save(deck);
    col.getSched().extendLimits(n,0);
    finishCongrats();
    resetAndUpdateValuesFromDeck();
  }
 catch (  NumberFormatException e) {
  }
catch (  JSONException e) {
    throw new RuntimeException(e);
  }
}
}
}
;
break;
case CUSTOM_STUDY_REV:
if (AnkiDroidApp.colIsOpen()) {
Collection col=AnkiDroidApp.getCol();
mCustomStudyTextView1.setText(res.getString(R.string.custom_study_rev_total_rev,col.getSched().totalRevForCurrentDeck()));
}
mCustomStudyTextView2.setText(res.getString(R.string.custom_study_rev_extend));
mCustomStudyEditText.setText(Integer.toString(AnkiDroidApp.getSharedPrefs(getActivity()).getInt("extendRev",10)));
listener=new DialogInterface.OnClickListener(){
@Override public void onClick(DialogInterface dialog,int which){
if (AnkiDroidApp.colIsOpen()) {
try {
int n=Integer.parseInt(mCustomStudyEditText.getText().toString());
AnkiDroidApp.getSharedPrefs(getActivity()).edit().putInt("extendRev",n).commit();
Collection col=AnkiDroidApp.getCol();
JSONObject deck=col.getDecks().current();
deck.put("extendRev",n);
col.getDecks().save(deck);
col.getSched().extendLimits(0,n);
finishCongrats();
resetAndUpdateValuesFromDeck();
}
 catch (NumberFormatException e) {
}
catch (JSONException e) {
throw new RuntimeException(e);
}
}
}
}
;
break;
case CUSTOM_STUDY_FORGOT:
mCustomStudyTextView1.setText("");
mCustomStudyTextView2.setText(res.getString(R.string.custom_study_forgotten));
mCustomStudyEditText.setText(Integer.toString(AnkiDroidApp.getSharedPrefs(getActivity()).getInt("forgottenDays",2)));
listener=new DialogInterface.OnClickListener(){
@Override public void onClick(DialogInterface dialog,int which){
int forgottenDays=Integer.parseInt(((EditText)mCustomStudyEditText).getText().toString());
JSONArray ar=new JSONArray();
try {
ar.put(0,1);
}
 catch (JSONException e) {
throw new RuntimeException(e);
}
createFilteredDeck(ar,new Object[]{String.format(Locale.US,"rated:%d:1",forgottenDays),9999,Sched.DYN_RANDOM},false);
}
}
;
break;
case CUSTOM_STUDY_AHEAD:
mCustomStudyTextView1.setText("");
mCustomStudyTextView2.setText(res.getString(R.string.custom_study_ahead));
mCustomStudyEditText.setText(Integer.toString(AnkiDroidApp.getSharedPrefs(getActivity()).getInt("aheadDays",1)));
listener=new DialogInterface.OnClickListener(){
@Override public void onClick(DialogInterface dialog,int which){
int days=Integer.parseInt(((EditText)mCustomStudyEditText).getText().toString());
createFilteredDeck(new JSONArray(),new Object[]{String.format(Locale.US,"prop:due<=%d",days),9999,Sched.DYN_DUE},true);
}
}
;
break;
case CUSTOM_STUDY_RANDOM:
mCustomStudyTextView1.setText("");
mCustomStudyTextView2.setText(res.getString(R.string.custom_study_random));
mCustomStudyEditText.setText(Integer.toString(AnkiDroidApp.getSharedPrefs(getActivity()).getInt("randomCards",100)));
listener=new DialogInterface.OnClickListener(){
@Override public void onClick(DialogInterface dialog,int which){
int randomCards=Integer.parseInt(((EditText)mCustomStudyEditText).getText().toString());
createFilteredDeck(new JSONArray(),new Object[]{"",randomCards,Sched.DYN_RANDOM},true);
}
}
;
break;
case CUSTOM_STUDY_PREVIEW:
mCustomStudyTextView1.setText("");
mCustomStudyTextView2.setText(res.getString(R.string.custom_study_preview));
mCustomStudyEditText.setText(Integer.toString(AnkiDroidApp.getSharedPrefs(getActivity()).getInt("previewDays",1)));
listener=new DialogInterface.OnClickListener(){
@Override public void onClick(DialogInterface dialog,int which){
String previewDays=((EditText)mCustomStudyEditText).getText().toString();
createFilteredDeck(new JSONArray(),new Object[]{"is:new added:" + previewDays,9999,Sched.DYN_OLDEST},true);
}
}
;
break;
case CUSTOM_STUDY_TAGS:
mCustomStudyTextView1.setText("");
mCustomStudyTextView2.setText(res.getString(R.string.custom_study_tags));
mCustomStudyEditText.setText(AnkiDroidApp.getSharedPrefs(getActivity()).getString("customTags",""));
listener=new DialogInterface.OnClickListener(){
@Override public void onClick(DialogInterface dialog,int which){
String tags=((EditText)mCustomStudyEditText).getText().toString();
createFilteredDeck(new JSONArray(),new Object[]{"(is:new or is:due) " + tags,9999,Sched.DYN_RANDOM},true);
}
}
;
break;
}
builder2.setContentView(mCustomStudyDetailsView);
builder2.setCancelable(true);
builder2.setNegativeButton(R.string.cancel,null);
builder2.setPositiveButton(R.string.ok,listener);
builder2.show();
}
}
);
builder1.setCancelable(true);
dialog=builder1.create();
break;
default :
dialog=null;
}
dialog.setOwnerActivity(getActivity());
return dialog;
}
