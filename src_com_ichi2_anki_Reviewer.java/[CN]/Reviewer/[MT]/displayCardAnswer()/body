{
  Log.i(AnkiDroidApp.TAG,"displayCardAnswer");
  sDisplayAnswer=true;
  Sound.stopSounds();
  if (mPrefTimer) {
    mCardTimer.stop();
  }
  String displayString="";
  if (mPrefWriteAnswers) {
    mAnswerField.setVisibility(View.GONE);
    if (mCurrentCard != null) {
      String userAnswer=mAnswerField.getText().toString();
      Matcher matcher=sSpanPattern.matcher(Utils.stripHTMLMedia(mCurrentCard.getAnswer()));
      String correctAnswer=matcher.replaceAll("");
      matcher=sBrPattern.matcher(correctAnswer);
      correctAnswer=matcher.replaceAll("\n");
      matcher=Sound.sSoundPattern.matcher(correctAnswer);
      correctAnswer=matcher.replaceAll("");
      matcher=Image.sImagePattern.matcher(correctAnswer);
      correctAnswer=matcher.replaceAll("");
      Log.i(AnkiDroidApp.TAG,"correct answer = " + correctAnswer);
      DiffEngine diff=new DiffEngine();
      displayString=enrichWithQASpan(diff.diff_prettyHtml(diff.diff_main(userAnswer,correctAnswer)) + "<br/>" + mCurrentCard.getAnswer(),true);
    }
    InputMethodManager inputMethodManager=(InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
    inputMethodManager.hideSoftInputFromWindow(mAnswerField.getWindowToken(),0);
  }
 else {
    displayString=enrichWithQASpan(mCurrentCard.getAnswer(),true);
  }
  if (isQuestionDisplayed()) {
    StringBuffer sb=new StringBuffer();
    sb.append(enrichWithQASpan(mCurrentCard.getQuestion(),false));
    sb.append("<a name=\"question\"></a><hr/>");
    sb.append(displayString);
    displayString=sb.toString();
  }
  mFlipCard.setVisibility(View.GONE);
  showEaseButtons();
  updateCard(displayString);
}
