{
  if (mShakeEnabled) {
    mSensorManager.unregisterListener(mSensorListener);
  }
  super.onStop();
  DeckTask.waitToFinish();
  if (!isFinishing()) {
    Deck deck=AnkiDroidApp.deck();
    if (deck != null) {
      deck.commitToDB();
    }
  }
  WidgetStatus.update(getBaseContext(),true);
}
