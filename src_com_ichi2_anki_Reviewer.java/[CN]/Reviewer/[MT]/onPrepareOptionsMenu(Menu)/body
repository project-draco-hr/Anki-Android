{
  MenuItem item=menu.findItem(MENU_MARK);
  if (mCurrentCard == null) {
    return false;
  }
  mCurrentCard.loadTags();
  if (mCurrentCard.hasTag(Deck.TAG_MARKED)) {
    item.setTitle(R.string.menu_marked);
    item.setIcon(R.drawable.ic_menu_star_on);
  }
 else {
    item.setTitle(R.string.menu_mark_card);
    item.setIcon(R.drawable.ic_menu_star_off);
  }
  if (mPrefTextSelection) {
    item=menu.findItem(MENU_SEARCH);
    Log.i(AnkiDroidApp.TAG,"Clipboard has text = " + mClipboard.hasText());
    Log.i(AnkiDroidApp.TAG,"Is intent available = " + Utils.isIntentAvailable(this,"sk.baka.aedict.action.ACTION_SEARCH_EDICT"));
    boolean lookupPossible=mClipboard.hasText() && Utils.isIntentAvailable(this,"sk.baka.aedict.action.ACTION_SEARCH_EDICT");
    item.setEnabled(lookupPossible);
  }
  if (mPrefFullscreenReview) {
    mTextBarRed.setVisibility(View.GONE);
    mTextBarBlack.setVisibility(View.GONE);
    mTextBarBlue.setVisibility(View.GONE);
    if (mPrefTimer) {
      mCardTimer.setVisibility(View.GONE);
    }
    getWindow().setFlags(0,WindowManager.LayoutParams.FLAG_FULLSCREEN);
  }
  menu.findItem(MENU_UNDO).setEnabled(AnkiDroidApp.deck().undoAvailable());
  menu.findItem(MENU_REDO).setEnabled(AnkiDroidApp.deck().redoAvailable());
  return true;
}
