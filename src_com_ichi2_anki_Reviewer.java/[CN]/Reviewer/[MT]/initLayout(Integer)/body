{
  setContentView(layout);
  mMainLayout=findViewById(R.id.main_layout);
  Themes.setContentStyle(mMainLayout,Themes.CALLER_REVIEWER);
  mCardContainer=(FrameLayout)findViewById(R.id.flashcard_frame);
  setInAnimation(false);
  findViewById(R.id.top_bar).setOnClickListener(mCardStatisticsListener);
  mCardFrame=(LinearLayout)findViewById(R.id.flashcard);
  mTouchLayer=(FrameLayout)findViewById(R.id.touch_layer);
  mTouchLayer.setOnTouchListener(mGestureListener);
  if (mPrefTextSelection && mLongClickWorkaround) {
    mTouchLayer.setOnLongClickListener(mLongClickListener);
  }
  if (mPrefTextSelection) {
    mClipboard=(ClipboardManager)getSystemService(Context.CLIPBOARD_SERVICE);
  }
  mCardFrame.removeAllViews();
  if (mSimpleInterface) {
    mSimpleCard=new TextView(this);
    Themes.setRegularFont(mSimpleCard);
    mSimpleCard.setTextSize(mSimpleCard.getTextSize() * mDisplayFontSize / 100);
    mSimpleCard.setGravity(Gravity.CENTER);
    mCardFrame.addView(mSimpleCard);
  }
 else {
    mCard=createWebView();
    mCardFrame.addView(mCard);
  }
  if (!mChangeBorderStyle) {
    ((View)findViewById(R.id.flashcard_border)).setVisibility(View.VISIBLE);
  }
  if (mRefreshWebview && !mSimpleInterface) {
    mNextCard=createWebView();
    mNextCard.setVisibility(View.GONE);
    mCardFrame.addView(mNextCard,0);
    mCustomFontStyle=getCustomFontsStyle() + getDefaultFontStyle();
  }
  if (Integer.parseInt(android.os.Build.VERSION.SDK) < 8 && !mSimpleInterface) {
    mCard.setFocusableInTouchMode(true);
  }
  gestureDetector=new GestureDetector(new MyGestureDetector());
  if (mShakeEnabled) {
    mSensorManager=(SensorManager)getSystemService(Context.SENSOR_SERVICE);
    mSensorManager.registerListener(mSensorListener,mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER),SensorManager.SENSOR_DELAY_NORMAL);
    mAccel=0.00f;
    mAccelCurrent=SensorManager.GRAVITY_EARTH;
    mAccelLast=SensorManager.GRAVITY_EARTH;
  }
  Resources res=getResources();
  mEase1=(Button)findViewById(R.id.ease1);
  mEase1.setTextColor(res.getColor(R.color.next_time_failed_color));
  mEase1Layout=(LinearLayout)findViewById(R.id.flashcard_layout_ease1);
  mEase1Layout.setOnClickListener(mSelectEaseHandler);
  mEase2=(Button)findViewById(R.id.ease2);
  mEase2.setTextColor(res.getColor(R.color.next_time_usual_color));
  mEase2Layout=(LinearLayout)findViewById(R.id.flashcard_layout_ease2);
  mEase2Layout.setOnClickListener(mSelectEaseHandler);
  mEase3=(Button)findViewById(R.id.ease3);
  mEase3Layout=(LinearLayout)findViewById(R.id.flashcard_layout_ease3);
  mEase3Layout.setOnClickListener(mSelectEaseHandler);
  mEase4=(Button)findViewById(R.id.ease4);
  mEase4Layout=(LinearLayout)findViewById(R.id.flashcard_layout_ease4);
  mEase4Layout.setOnClickListener(mSelectEaseHandler);
  mNext1=(TextView)findViewById(R.id.nextTime1);
  mNext2=(TextView)findViewById(R.id.nextTime2);
  mNext3=(TextView)findViewById(R.id.nextTime3);
  mNext4=(TextView)findViewById(R.id.nextTime4);
  mNext1.setTextColor(res.getColor(R.color.next_time_failed_color));
  mNext2.setTextColor(res.getColor(R.color.next_time_usual_color));
  if (!mshowNextReviewTime) {
    ((LinearLayout)findViewById(R.id.nextTimeflip)).setVisibility(View.GONE);
    mNext1.setVisibility(View.GONE);
    mNext2.setVisibility(View.GONE);
    mNext3.setVisibility(View.GONE);
    mNext4.setVisibility(View.GONE);
  }
  mFlipCard=(Button)findViewById(R.id.flip_card);
  mFlipCardLayout=(LinearLayout)findViewById(R.id.flashcard_layout_flip);
  mFlipCardLayout.setOnClickListener(mFlipCardListener);
  mDefaultButtonDrawable=new Drawable[]{mFlipCardLayout.getBackground(),mEase1Layout.getBackground(),mEase2Layout.getBackground(),mEase3Layout.getBackground(),mEase4Layout.getBackground()};
  mTextBarRed=(TextView)findViewById(R.id.red_number);
  mTextBarBlack=(TextView)findViewById(R.id.black_number);
  mTextBarBlue=(TextView)findViewById(R.id.blue_number);
  if (mShowProgressBars) {
    mSessionYesBar=(View)findViewById(R.id.daily_bar);
    mSessionProgressBar=(View)findViewById(R.id.session_progress);
    mProgressBars=(LinearLayout)findViewById(R.id.progress_bars);
  }
  mCardTimer=(Chronometer)findViewById(R.id.card_time);
  if (mPrefTimer && (mConfigurationChanged)) {
    switchVisibility(mCardTimer,View.VISIBLE);
  }
  if (mShowProgressBars && (mConfigurationChanged)) {
    switchVisibility(mProgressBars,View.VISIBLE);
  }
  mChosenAnswer=(TextView)findViewById(R.id.choosen_answer);
  if (mPrefWhiteboard) {
    mWhiteboard=new Whiteboard(this,mInvertedColors,mBlackWhiteboard);
    FrameLayout.LayoutParams lp2=new FrameLayout.LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.FILL_PARENT);
    mWhiteboard.setLayoutParams(lp2);
    FrameLayout fl=(FrameLayout)findViewById(R.id.whiteboard);
    fl.addView(mWhiteboard);
    mWhiteboard.setOnTouchListener(new View.OnTouchListener(){
      @Override public boolean onTouch(      View v,      MotionEvent event){
        if (mShowWhiteboard) {
          return false;
        }
        if (gestureDetector.onTouchEvent(event)) {
          return true;
        }
        return false;
      }
    }
);
  }
  mAnswerField=(EditText)findViewById(R.id.answer_field);
  mNextTimeTextColor=getResources().getColor(R.color.next_time_usual_color);
  mNextTimeTextRecomColor=getResources().getColor(R.color.next_time_recommended_color);
  mForegroundColor=getResources().getColor(R.color.next_time_usual_color);
  if (mInvertedColors) {
    invertColors(true);
  }
  mLookUpIcon=findViewById(R.id.lookup_button);
  mLookUpIcon.setVisibility(View.GONE);
  mLookUpIcon.setOnClickListener(new OnClickListener(){
    @Override public void onClick(    View arg0){
      if (clipboardHasText()) {
        lookUp();
      }
    }
  }
);
  initControls();
}
