{
  Collection d=Shared.getEmptyCol();
  Long mid=d.getModels().getModels().entrySet().iterator().next().getKey();
  List<String> expected;
  List<String> actual;
  expected=Arrays.asList();
  actual=d.getMedia().filesInStr(mid,"aoeu");
  actual.retainAll(expected);
  assertEquals(expected.size(),actual.size());
  expected=Arrays.asList("foo.jpg");
  actual=d.getMedia().filesInStr(mid,"aoeu<img src='foo.jpg'>ao");
  actual.retainAll(expected);
  assertEquals(expected.size(),actual.size());
  expected=Arrays.asList("foo.jpg","bar.jpg");
  actual=d.getMedia().filesInStr(mid,"aoeu<img src='foo.jpg'><img src=\"bar.jpg\">ao");
  actual.retainAll(expected);
  assertEquals(expected.size(),actual.size());
  expected=Arrays.asList("foo.jpg");
  actual=d.getMedia().filesInStr(mid,"aoeu<img src=foo.jpg style=bar>ao");
  actual.retainAll(expected);
  assertEquals(expected.size(),actual.size());
  expected=Arrays.asList("one","two");
  actual=d.getMedia().filesInStr(mid,"<img src=one><img src=two>");
  actual.retainAll(expected);
  assertEquals(expected.size(),actual.size());
  expected=Arrays.asList("foo.jpg");
  actual=d.getMedia().filesInStr(mid,"aoeu<img src=\"foo.jpg\">ao");
  actual.retainAll(expected);
  assertEquals(expected.size(),actual.size());
  expected=Arrays.asList("foo.jpg","fo");
  actual=d.getMedia().filesInStr(mid,"aoeu<img src=\"foo.jpg\"><img class=yo src=fo>ao");
  actual.retainAll(expected);
  assertEquals(expected.size(),actual.size());
  expected=Arrays.asList("foo.mp3");
  actual=d.getMedia().filesInStr(mid,"aou[sound:foo.mp3]aou");
  actual.retainAll(expected);
  assertEquals(expected.size(),actual.size());
  assertEquals("aoeu",d.getMedia().strip("aoeu"));
  assertEquals("aoeuaoeu",d.getMedia().strip("aoeu[sound:foo.mp3]aoeu"));
  assertEquals("aoeu",d.getMedia().strip("a<img src=yo>oeu"));
  assertEquals("aoeu",d.getMedia().escapeImages("aoeu"));
  assertEquals("<img src='http://foo.com'>",d.getMedia().escapeImages("<img src='http://foo.com'>"));
  assertEquals("<img src=\"foo%20bar.jpg\">",d.getMedia().escapeImages("<img src=\"foo bar.jpg\">"));
}
