{
  StringBuilder stringBuilder=new StringBuilder();
  String contentLeft=content;
  String latex;
  Log.i(AnkiDroidApp.TAG,"parseLaTeX");
  Matcher matcher=sStandardPattern.matcher(contentLeft);
  while (matcher.find()) {
    latex=matcher.group(1);
    String img=mungeLatex(model,latex);
    img="latex-" + Utils.checksum(img) + ".png";
    String imgTag=matcher.group();
    int markerStart=contentLeft.indexOf(imgTag);
    stringBuilder.append(contentLeft.substring(0,markerStart));
    stringBuilder.append("<img src=\"" + img + "\" alt=\""+ latex+ "\">");
    contentLeft=contentLeft.substring(markerStart + imgTag.length());
  }
  stringBuilder.append(contentLeft);
  contentLeft=stringBuilder.toString();
  stringBuilder=new StringBuilder();
  matcher=sExpressionPattern.matcher(contentLeft);
  while (matcher.find()) {
    latex=matcher.group(1);
    String img="$" + mungeLatex(model,latex) + "$";
    img="latex-" + Utils.checksum(img) + ".png";
    String imgTag=matcher.group();
    int markerStart=contentLeft.indexOf(imgTag);
    stringBuilder.append(contentLeft.substring(0,markerStart));
    stringBuilder.append("<img src=\"" + img + "\" alt=\""+ latex+ "\">");
    contentLeft=contentLeft.substring(markerStart + imgTag.length());
  }
  stringBuilder.append(contentLeft);
  contentLeft=stringBuilder.toString();
  stringBuilder=new StringBuilder();
  matcher=sMathPattern.matcher(contentLeft);
  while (matcher.find()) {
    latex=matcher.group(1);
    String img="\\begin{displaymath}" + mungeLatex(model,latex) + "\\end{displaymath}";
    img="latex-" + Utils.checksum(img) + ".png";
    String imgTag=matcher.group();
    int markerStart=contentLeft.indexOf(imgTag);
    stringBuilder.append(contentLeft.substring(0,markerStart));
    stringBuilder.append("<img src=\"" + img + "\" alt=\""+ latex+ "\">");
    contentLeft=contentLeft.substring(markerStart + imgTag.length());
  }
  stringBuilder.append(contentLeft);
  return stringBuilder.toString();
}
