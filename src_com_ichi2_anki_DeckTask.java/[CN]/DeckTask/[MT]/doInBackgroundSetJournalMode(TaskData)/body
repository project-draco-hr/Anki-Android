{
  Log.i(AnkiDroidApp.TAG,"doInBackgroundSetJournalMode");
  String path=params[0].getString();
  Deck currentDeck=params[0].getDeck();
  if (currentDeck != null) {
    currentDeck.closeDeck(false);
  }
  int len=0;
  File[] fileList;
  File dir=new File(path);
  fileList=dir.listFiles(new AnkiFilter());
  if (dir.exists() && dir.isDirectory() && fileList != null) {
    len=fileList.length;
  }
 else {
    return null;
  }
  if (len > 0 && fileList != null) {
    Log.i(AnkiDroidApp.TAG,"Set journal mode: number of anki files = " + len);
    for (    File file : fileList) {
      String filePath=file.getAbsolutePath();
      Deck deck=Deck.openDeck(filePath,false);
      if (deck != null) {
        Log.i(AnkiDroidApp.TAG,"Journal mode of file " + filePath + " set");
        deck.closeDeck(false);
      }
    }
  }
  return null;
}
