{
  Deck deck=params[0].getDeck();
  Card oldCard=params[0].getCard();
  int ease=params[0].getInt();
  boolean lastCardInQueue=params[0].isLastCardInQueue();
  Card newCard;
  AnkiDb ankiDB=AnkiDatabaseManager.getDatabase(deck.getDeckPath());
  ankiDB.getDatabase().beginTransaction();
  try {
    if (oldCard != null) {
      deck.answerCard(oldCard,ease);
      Log.i(AnkiDroidApp.TAG,"leech flag: " + oldCard.getLeechFlag());
    }
    newCard=deck.getCard();
    if (oldCard != null) {
      publishProgress(new TaskData(newCard,oldCard.getLeechFlag(),oldCard.getSuspendedFlag(),lastCardInQueue));
    }
 else {
      publishProgress(new TaskData(newCard));
    }
    ankiDB.getDatabase().setTransactionSuccessful();
  }
  finally {
    ankiDB.getDatabase().endTransaction();
  }
  return null;
}
