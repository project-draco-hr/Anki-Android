{
  Deck deck=params[0].getDeck();
  Card editCard=params[0].getCard();
  Fact editFact=editCard.getFact();
  int cardReset=params[0].getInt();
  String undoName=Deck.UNDO_TYPE_EDIT_CARD;
  deck.setUndoStart(undoName,editCard.getId());
  editFact.setModified(true,deck,false);
  editFact.toDb();
  deck.flushMod();
  deck.setUndoEnd(undoName);
  if (cardReset == 1) {
    publishProgress(new TaskData(deck.getCard()));
  }
 else {
    publishProgress(new TaskData(deck.cardFromId(editCard.getId())));
  }
  return null;
}
