{
  Deck deck=params[0].getDeck();
  Card newCard;
  long currentCardId=params[0].getLong();
  boolean inReview=params[0].getBoolean();
  long oldCardId=0;
  String undoType=null;
  try {
    AnkiDb ankiDB=AnkiDatabaseManager.getDatabase(deck.getDeckPath());
    ankiDB.getDatabase().beginTransaction();
    try {
      oldCardId=deck.redo(currentCardId,inReview);
      newCard=deck.getCard();
      if (oldCardId != 0 && newCard != null && oldCardId != newCard.getId()) {
        newCard=deck.cardFromId(oldCardId);
      }
      publishProgress(new TaskData(newCard));
      ankiDB.getDatabase().setTransactionSuccessful();
    }
  finally {
      ankiDB.getDatabase().endTransaction();
    }
    undoType=deck.getUndoType();
    if (undoType == Deck.UNDO_TYPE_SUSPEND_CARD) {
      undoType="redo suspend";
    }
  }
 catch (  RuntimeException e) {
    Log.e(AnkiDroidApp.TAG,"doInBackgroundRedo - RuntimeException on redoing: " + e);
    AnkiDroidApp.saveExceptionReportFile(e,"doInBackgroundRedo");
    return new TaskData(undoType,oldCardId,false);
  }
  return new TaskData(undoType,oldCardId,true);
}
