{
  View decorView=activity.getWindow().getDecorView();
  decorView.setOnSystemUiVisibilityChangeListener(new View.OnSystemUiVisibilityChangeListener(){
    @Override public void onSystemUiVisibilityChange(    int visibility){
      ActionBar ab=activity.getSupportActionBar();
      if ((visibility & View.SYSTEM_UI_FLAG_FULLSCREEN) == 0) {
        if (ab != null) {
          ab.show();
        }
      }
 else {
        if (ab != null) {
          ab.hide();
        }
      }
    }
  }
);
}
