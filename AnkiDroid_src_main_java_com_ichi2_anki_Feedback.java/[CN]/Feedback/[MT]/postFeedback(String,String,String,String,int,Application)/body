{
  Payload result=new Payload(null);
  List<NameValuePair> pairs=null;
  if (!isErrorType(type)) {
    pairs=new ArrayList<NameValuePair>();
    pairs.add(new BasicNameValuePair("type",type));
    pairs.add(new BasicNameValuePair("groupid",groupId));
    pairs.add(new BasicNameValuePair("index","0"));
    pairs.add(new BasicNameValuePair("message",feedback));
    addTimestamp(pairs);
  }
 else {
    pairs=Feedback.extractPairsFromError(type,feedback,groupId,index,app);
    if (pairs == null) {
      result.success=false;
      result.result=null;
    }
  }
  HttpClient httpClient=new DefaultHttpClient();
  HttpPost httpPost=new HttpPost(url);
  httpPost.addHeader("User-Agent","AnkiDroid");
  try {
    httpPost.setEntity(new UrlEncodedFormEntity(pairs));
    HttpResponse response=httpClient.execute(httpPost);
    Timber.e(String.format("Bug report posted to %s",url));
    int respCode=response.getStatusLine().getStatusCode();
switch (respCode) {
case 200:
      result.success=true;
    result.returnType=respCode;
  result.result=Utils.convertStreamToString(response.getEntity().getContent());
Timber.i(String.format("postFeedback OK: %s",result.result));
break;
default :
Timber.e(String.format("postFeedback failure: %d - %s",response.getStatusLine().getStatusCode(),response.getStatusLine().getReasonPhrase()));
result.success=false;
result.returnType=respCode;
result.result=response.getStatusLine().getReasonPhrase();
break;
}
}
 catch (ClientProtocolException ex) {
Timber.e(ex,"ClientProtocolException: ");
result.success=false;
result.result=ex.toString();
}
catch (IOException ex) {
Timber.e(ex,"IOException: ");
result.success=false;
result.result=ex.toString();
}
return result;
}
