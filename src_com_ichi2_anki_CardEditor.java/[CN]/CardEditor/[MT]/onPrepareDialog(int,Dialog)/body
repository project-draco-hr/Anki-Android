{
  StyledDialog ad=(StyledDialog)dialog;
switch (id) {
case DIALOG_TAGS:
    if (allTags == null) {
      String[] oldTags=AnkiDroidApp.deck().allUserTags();
      Log.i(AnkiDroidApp.TAG,"all tags: " + Arrays.toString(oldTags));
      allTags=new String[oldTags.length];
      for (int i=0; i < oldTags.length; i++) {
        allTags[i]=oldTags[i];
      }
    }
  mSelectedTags.clear();
List<String> selectedList=Arrays.asList(Utils.parseTags(mFactTags));
int length=allTags.length;
boolean[] checked=new boolean[length];
for (int i=0; i < length; i++) {
String tag=allTags[i];
if (selectedList.contains(tag)) {
checked[i]=true;
mSelectedTags.add(tag);
}
}
ad.setMultiChoiceItems(allTags,checked,new DialogInterface.OnClickListener(){
@Override public void onClick(DialogInterface arg0,int which){
String tag=allTags[which];
if (mSelectedTags.contains(tag)) {
Log.i(AnkiDroidApp.TAG,"unchecked tag: " + tag);
mSelectedTags.remove(tag);
}
 else {
Log.i(AnkiDroidApp.TAG,"checked tag: " + tag);
mSelectedTags.add(tag);
}
}
}
);
break;
}
}
