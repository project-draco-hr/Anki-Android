{
  super.onCreate(savedInstanceState);
  registerExternalStorageListener();
  setContentView(R.layout.card_editor);
  mFieldsLayoutContainer=(LinearLayout)findViewById(R.id.CardEditorEditFieldsLayout);
  mSave=(Button)findViewById(R.id.CardEditorSaveButton);
  mCancel=(Button)findViewById(R.id.CardEditorCancelButton);
  mEditorCard=Reviewer.getEditorCard();
  Fact cardFact=mEditorCard.getFact();
  TreeSet<Field> fields=cardFact.getFields();
  mEditFields=new LinkedList<FieldEditText>();
  Iterator<Field> iter=fields.iterator();
  while (iter.hasNext()) {
    FieldEditText newTextbox=new FieldEditText(this,iter.next());
    TextView label=newTextbox.getLabel();
    mEditFields.add(newTextbox);
    mFieldsLayoutContainer.addView(label);
    mFieldsLayoutContainer.addView(newTextbox);
  }
  mSave.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      Iterator<FieldEditText> iter=mEditFields.iterator();
      String undoName="Edit Card";
      AnkiDroidApp.deck().setUndoStart(undoName);
      while (iter.hasNext()) {
        FieldEditText current=iter.next();
        current.updateField();
      }
      AnkiDroidApp.deck().setUndoStart(undoName);
      setResult(RESULT_OK);
      finish();
    }
  }
);
  mCancel.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      setResult(RESULT_CANCELED);
      finish();
    }
  }
);
}
