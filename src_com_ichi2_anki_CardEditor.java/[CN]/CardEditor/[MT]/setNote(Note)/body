{
  try {
    if (note == null) {
      if (mCol.getDecks().isDyn(mCurrentDid)) {
        mCurrentDid=1;
      }
      JSONObject model=mCol.getModels().current();
      mEditorNote=new Note(mCol,model);
      mEditorNote.model().put("did",mCurrentDid);
      mModelButton.setText(getResources().getString(R.string.CardEditorModel,model.getString("name")));
      if (mCurrentTags == null) {
        mCurrentTags=new ArrayList<String>();
      }
    }
 else {
      mEditorNote=note;
      mCurrentDid=mCurrentEditedCard.getDid();
      mCurrentTags=mEditorNote.getTags();
    }
  }
 catch (  JSONException e) {
    throw new RuntimeException(e);
  }
  updateDeck();
  updateTags();
  populateEditFields();
  swapText(true);
}
