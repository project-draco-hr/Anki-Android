{
  try {
    if (note == null) {
      mEditorNote=mCol.newNote();
      mModelButton.setText(getResources().getString(R.string.CardEditorModel,mCol.getModels().current().getString("name")));
      JSONArray tags=mEditorNote.model().getJSONArray("tags");
      for (int i=0; i < tags.length(); i++) {
        mEditorNote.addTag(tags.getString(i));
      }
      mCurrentDid=mEditorNote.getDid();
    }
 else {
      mEditorNote=note;
      mCurrentDid=mCurrentEditedCard.getDid();
    }
  }
 catch (  JSONException e) {
    throw new RuntimeException(e);
  }
  mCurrentTags=mEditorNote.getTags();
  updateDeck();
  updateTags();
  populateEditFields();
  swapText(true);
}
