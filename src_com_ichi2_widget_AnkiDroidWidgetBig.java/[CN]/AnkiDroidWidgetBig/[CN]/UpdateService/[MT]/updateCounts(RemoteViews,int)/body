{
  DeckStatus[] decks=WidgetStatus.fetch(this);
  int eta=0;
  int reps=0;
  int due=0;
  for (  DeckStatus d : decks) {
    eta+=d.mEta;
    reps+=d.mTime;
    due+=d.mFailedCards + d.mNewCards + d.mDueCards;
  }
  int totalreps=reps + due;
  int progressTotal=0;
  if (totalreps != 0) {
    progressTotal=(int)Math.round((100.0d * reps) / totalreps);
  }
  updateViews.setProgressBar(R.id.widget_big_progress_total,100,progressTotal,false);
  if (eta == 0) {
    updateViews.setViewVisibility(R.id.widget_big_eta,View.INVISIBLE);
  }
 else {
    updateViews.setViewVisibility(R.id.widget_big_eta,View.VISIBLE);
    updateViews.setTextViewText(R.id.widget_big_eta,eta > 99 ? "\u2027\u2027\u2027" : Integer.toString(eta));
  }
switch (view) {
case VIEW_SHOW_QUESTION:
case VIEW_NOTHING_DUE:
    updateViews.setTextViewText(R.id.widget_big_counts,getDeckStatusString(sLoadedDeck,sCard));
  double sessionProgress=sLoadedDeck.getSessionProgress(true);
if (sessionProgress == -1) {
  updateViews.setViewVisibility(R.id.widget_big_progress_frame_deck,View.INVISIBLE);
}
 else {
  updateViews.setProgressBar(R.id.widget_big_progress_deck,100,(int)(sessionProgress * 100),false);
  updateViews.setViewVisibility(R.id.widget_big_progress_frame_deck,View.VISIBLE);
}
sTomorrowDues=null;
break;
case VIEW_CONGRATS:
if (sTomorrowDues != null && sTomorrowDues.length > 0) {
updateViews.setViewVisibility(R.id.widget_big_totalcongrats,View.VISIBLE);
setDeckCounts(updateViews,sTomorrowDues);
}
break;
case VIEW_DECKS:
updateViews.setTextViewText(R.id.widget_big_counts,"");
updateViews.setViewVisibility(R.id.widget_big_progress_frame_deck,View.INVISIBLE);
updateViews.setViewVisibility(R.id.widget_big_deckfield,View.VISIBLE);
updateViews.setViewVisibility(R.id.widget_big_nothing_due,View.INVISIBLE);
setDeckCounts(updateViews,decks);
if (due != 0) {
updateViews.setViewVisibility(R.id.widget_big_totalcongrats,View.GONE);
updateViews.setViewVisibility(R.id.widget_big_decketa,View.VISIBLE);
updateViews.setTextViewText(R.id.widget_big_decketa,"???????????????\n" + getResources().getQuantityString(R.plurals.widget_big_eta,eta,eta));
}
 else if (sTomorrowDues == null) {
updateViews.setViewVisibility(R.id.widget_big_totalcongrats,View.GONE);
updateViews.setViewVisibility(R.id.widget_big_progressbar,View.VISIBLE);
sWaitForAsyncTask=true;
if (sGetTomorrowCountAsyncTask == null || sGetTomorrowCountAsyncTask.getStatus() != AsyncTask.Status.RUNNING) {
sGetTomorrowCountAsyncTask=new GetTomorrowDueAsyncTask();
sGetTomorrowCountAsyncTask.execute(PrefSettings.getSharedPrefs(AnkiDroidWidgetBig.UpdateService.this).getString("deckPath",AnkiDroidApp.getStorageDirectory() + "/AnkiDroid"));
}
}
 else {
updateViews.setViewVisibility(R.id.widget_big_totalcongrats,View.VISIBLE);
sCurrentView=VIEW_CONGRATS;
updateCounts(updateViews,VIEW_CONGRATS);
}
break;
}
}
