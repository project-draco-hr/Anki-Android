{
  mDatabase=SQLiteDatabase.openDatabase(ankiFilename,null,SQLiteDatabase.OPEN_READWRITE | SQLiteDatabase.NO_LOCALIZED_COLLATORS);
  if (mDatabase != null) {
    Cursor cur=null;
    try {
      cur=mDatabase.rawQuery("PRAGMA journal_mode = DELETE",null);
      if (cur.moveToFirst()) {
        String journalMode=cur.getString(0);
        Log.w(AnkiDroidApp.TAG,"Trying to set journal mode to DELETE. Result: " + journalMode);
        if (journalMode.equalsIgnoreCase("delete")) {
          PrefSettings.getSharedPrefs(AnkiDroidApp.getInstance().getBaseContext()).edit().putInt("walWarning",NO_WAL_WARNING).commit();
        }
 else {
          Log.e(AnkiDroidApp.TAG,"Journal could not be changed to DELETE. Deck will probably be unreadable on sqlite < 3.7");
          SharedPreferences prefs=PrefSettings.getSharedPrefs(AnkiDroidApp.getInstance().getBaseContext());
          if (prefs.getInt("walWarning",NO_WAL_WARNING) == NO_WAL_WARNING) {
            prefs.edit().putInt("walWarning",WAL_WARNING_SHOW).commit();
          }
        }
      }
    }
  finally {
      if (cur != null) {
        cur.close();
      }
    }
  }
}
